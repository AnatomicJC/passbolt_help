<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.7.0">Jekyll</generator><link href="https://help.passbolt.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://help.passbolt.com/" rel="alternate" type="text/html" /><updated>2018-06-14T20:19:45+05:30</updated><id>https://help.passbolt.com/</id><title type="html">Passbolt | Help</title><subtitle>The help site for passbolt, the open source password manager for teams. This site contains frequently asked questions, article to troubleshoot common issues, installation tutorials, blueprints for developers, and more!</subtitle><entry><title type="html">Update passbolt server component (v2)</title><link href="https://help.passbolt.com/hosting/update.html" rel="alternate" type="text/html" title="Update passbolt server component (v2)" /><published>2018-05-02T05:30:00+05:30</published><updated>2018-05-02T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/update</id><content type="html" xml:base="https://help.passbolt.com/hosting/update.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;h2 id=&quot;which-update-process-to-follow&quot;&gt;Which update process to follow?&lt;/h2&gt;

    &lt;p&gt;Each passbolt release follows the concept of &lt;a href=&quot;http://www.semver.org&quot;&gt;Semantic Versioning&lt;/a&gt;. Given a version number MAJOR.MINOR.PATCH, we increment as follow:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;PATCH&lt;/strong&gt; version when we make backwards-compatible bug fixes. So let’s say you are running passbolt v2.0.2 and the latest one available is v2.0.3 you will need to perform a patch update.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;MINOR&lt;/strong&gt; version when we add functionality in a backwards-compatible manner. Similarly say you have passbolt v2.0.3 installed and the latest version available is v2.1.0, you will need to perform a minor version update.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;MAJOR&lt;/strong&gt; version when incompatible API changes are made. You get the deal for major version update: that would mean going from v1 to v2 for example.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;where-to-find-the-latest-release-version-number&quot;&gt;Where to find the latest release version number?&lt;/h2&gt;

    &lt;p&gt;You can find information about which version is the latest in the &lt;a href=&quot;?php echo Router::url('/release/notes',true); ?&quot;&gt;release notes&lt;/a&gt;. It is generally a good idea to check these notes before running an update. You can also find it on the official &lt;a href=&quot;https://github.com/passbolt/passbolt_api/blob/master/app/Config/version.php&quot;&gt;GIT repository&lt;/a&gt;.&lt;/p&gt;

    &lt;h2 id=&quot;where-to-find-the-version-number-for-a-given-installation&quot;&gt;Where to find the version number for a given installation?&lt;/h2&gt;

    &lt;p&gt;You can check &lt;code class=&quot;highlighter-rouge&quot;&gt;app/Config/version.php&lt;/code&gt; to know the version number for your local instance. You can also hover on the &lt;em&gt;&lt;span class=&quot;visuallyhidden&quot;&gt;heart&lt;/span&gt;&lt;/em&gt; icon at the bottom right corner of any passbolt screen. The first item is the server version, the second the one from the browser extension.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/05/AN_footer_version_help.png&quot; alt=&quot;footer version helper&quot; style=&quot;max-width:210px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. footer version helper&lt;/span&gt;
&lt;/figure&gt;

    &lt;h2 id=&quot;major-update&quot;&gt;Major update&lt;/h2&gt;

    &lt;p&gt;Please see the following documentation to &lt;a href=&quot;/hosting/upgrade&quot;&gt;Update from v1 to v2&lt;/a&gt;&lt;/p&gt;

    &lt;h2 id=&quot;minor-update&quot;&gt;Minor update&lt;/h2&gt;

    &lt;p&gt;Every now and again some releases will introduce some database and/or configuration files changes. 
Here is a step by step guide on how to perform a minor update. Just replace the version numbers where necessary.&lt;/p&gt;

    &lt;h4 id=&quot;take-your-site-down&quot;&gt;1. Take your site down&lt;/h4&gt;

    &lt;p&gt;Create a temporary webserver configuration to redirect all the requests to a maintenance page. 
You can find resources how to do this online: &lt;a href=&quot;http://stackoverflow.com/questions/21709026/apache-enable-maintenance-mode-across-all-virtual-hosts&quot;&gt;here is an example for apache&lt;/a&gt; .&lt;/p&gt;

    &lt;h4 id=&quot;get-the-latest-release&quot;&gt;2. Get the latest release&lt;/h4&gt;

    &lt;p&gt;You can also pull the latest version directly from master:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git pull origin master
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You can also pull specific versions:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git fetch
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout tags/v2.0.3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;update-the-libraries&quot;&gt;3. Update the libraries&lt;/h4&gt;

    &lt;p&gt;Some libraries are not packaged with the software but need to be updated using composer, based on 
what is recommended in the composer.lock. This file is provided by passbolt.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;composer &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;run-the-migration-script&quot;&gt;4. Run the migration script&lt;/h4&gt;

    &lt;p&gt;You can run the database migration scripts as follow:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake passbolt migrate &lt;span class=&quot;nt&quot;&gt;--backup&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;As you can see with the command above you can optional ask the application to create a database backup.
This is usefull in case you run into any issues with the new version and need to revert to an old but working one.&lt;/p&gt;

    &lt;p&gt;This backup will be placed in &lt;code class=&quot;highlighter-rouge&quot;&gt;./tmp/cache/database/backup/backup_timestamp.sql&lt;/code&gt;.&lt;/p&gt;

    &lt;h4 id=&quot;put-your-site-back-online&quot;&gt;5. Put your site back online!&lt;/h4&gt;

    &lt;p&gt;As an administrator (or as any user in debug mode) you can go and check on the /healthcheck page to see 
if your instance configuration is looking good.&lt;/p&gt;

    &lt;h2 id=&quot;patch-update&quot;&gt;Patch update&lt;/h2&gt;

    &lt;p&gt;Performing a patch update is the easiest. All you need to do is checkout the latest version.&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git pull origin master
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You can also checkout a specific version and use branches to switch versions. For example for version 2.0.3:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git fetch &lt;span class=&quot;nt&quot;&gt;--tags&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git checkout tags/v2.0.3 &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; tags/v2.0.3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;troubleshooting&quot;&gt;Troubleshooting&lt;/h2&gt;

    &lt;h4 id=&quot;verifying-the-status-of-the-application&quot;&gt;Verifying the status of the application&lt;/h4&gt;
    &lt;p&gt;Optionally, you can login as an administrator and check the status on the healthcheck page:&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/screenshots/AD_healthcheck.jpg&quot; alt=&quot;Example of healthcheck screen&quot; style=&quot;max-width:;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Example of healthcheck screen&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;You can also run the following command:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./bin/cake passbolt healthcheck
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;if-you-run-into-some-issues&quot;&gt;If you run into some issues&lt;/h4&gt;

    &lt;p&gt;If you run into some issues:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Make a copy or screenshot of the errors messages displayed on the screen&lt;/li&gt;
      &lt;li&gt;Check for error message in the &lt;code class=&quot;highlighter-rouge&quot;&gt;logs&lt;/code&gt; directory&lt;/li&gt;
      &lt;li&gt;Check for error message in the browser console&lt;/li&gt;
      &lt;li&gt;Checkout the previous working version using git&lt;/li&gt;
      &lt;li&gt;Drop the database and load your backup data to restore to a previously working version&lt;/li&gt;
      &lt;li&gt;Note down the the details of you environment: your OS, php, mysql environment versions.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;Where to get help:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;If you are a Passbolt Pro Edition subscriber send us an &lt;a href=&quot;mailto:contact@passbolt.com&quot;&gt;email&lt;/a&gt; with the details.&lt;/li&gt;
      &lt;li&gt;If you are a Passbolt Community Edition user you can open new thread on the &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot;&gt;community forum&lt;/a&gt;.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;The more information you provide about what you did, what you tried, how your environment look like,
the easiest it will be for people to help you.&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
May
2nd,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Are you still using passbolt v1? Check out the previous version of this article.&lt;/p&gt;
    
    &lt;a href=&quot;/hosting/update-v1&quot; class=&quot;button &quot;&gt;See previous version&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><summary type="html"></summary></entry><entry><title type="html">Upgrade to Passbolt Pro</title><link href="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce.html" rel="alternate" type="text/html" title="Upgrade to Passbolt Pro" /><published>2018-04-15T05:30:00+05:30</published><updated>2018-04-15T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;There are many ways you can upgrade your version 1 or version 2 Community Edition (CE) to Passbolt Pro.
This page list the options and will point you to the right manual.&lt;/p&gt;

    &lt;h3 id=&quot;upgrade-from-ce-v2&quot;&gt;Upgrade from CE v2&lt;/h3&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/hosting/upgrade/pro/upgrade-pro-from-ce-v2&quot;&gt;Upgrade CE v2.x to Pro using source&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/hosting/upgrade/pro/upgrade-pro-from-v2-docker&quot;&gt;Upgrade CE v2.x to Pro using docker&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h3 id=&quot;upgrade-from-v1&quot;&gt;Upgrade from v1&lt;/h3&gt;

    &lt;h4 id=&quot;using-docker&quot;&gt;Using docker&lt;/h4&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/hosting/upgrade/pro/upgrade-pro-from-v1-docker&quot;&gt;Upgrade CE v2.x to Pro using docker&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h4 id=&quot;using-source&quot;&gt;Using source&lt;/h4&gt;
    &lt;p&gt;If the server running Passbolt V1 doesn’t and cannot match the requirements listed bellow, you will need a new server 
to upgrade to Passbolt Pro.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/hosting/upgrade/pro/upgrade-pro-from-ce-v1-same-server&quot;&gt;Upgrade CE v1.x to Pro on the same server&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/hosting/upgrade/pro/upgrade-pro-from-ce-v1-new-server&quot;&gt;Upgrade CE v1.x to Pro on a new server&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h3 id=&quot;can-i-upgrade-on-the-same-server&quot;&gt;Can I upgrade on the same server?&lt;/h3&gt;
    &lt;p&gt;If the server running Passbolt v1 matches the requirements listed bellow, you can upgrade to Passbolt Pro on the same server.
If it does not match, you can also upgrade your distribution packages, or install on a new server.
Generally the major dependency upgrade is PHP7. (In Debian, using dotdeb replacements work like a charm).&lt;/p&gt;

    &lt;h4 id=&quot;requirements&quot;&gt;Requirements&lt;/h4&gt;
    &lt;p&gt;Passbolt is reported to work on a large variety of operating system configurations. 
Therefore this help page is a generic guide that should work for most environments.&lt;/p&gt;

    &lt;p&gt;If you run into any issues with your particular configuration, 
&lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot;&gt;please check the forum&lt;/a&gt;. 
Maybe someone else has had your issue. If not, make a post and the community will try to help you.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Any Unix-like major distribution (Debian, Centos, Ubuntu, *BSD)&lt;/li&gt;
      &lt;li&gt;A webserver (Apache or Nginx)&lt;/li&gt;
      &lt;li&gt;A TLS server certificate for HTTPS&lt;/li&gt;
      &lt;li&gt;PHP &amp;gt;= 7.0.0&lt;/li&gt;
      &lt;li&gt;Mysql &amp;gt;= 5.5.59&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://getcomposer.org/download/&quot;&gt;Composer&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://gnupg.org/&quot;&gt;GnuPG&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://git-scm.com/&quot;&gt;Git&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;The following PHP extensions (that may or may not come by default):&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;http://php.net/manual/en/gnupg.installation.php&quot;&gt;PHP-GNUPG&lt;/a&gt;: for key verification and authentication.&lt;/li&gt;
      &lt;li&gt;Cakephp default requirements: Intl, mbstring, simplexml&lt;/li&gt;
      &lt;li&gt;Image manipulation: gd or imagick&lt;/li&gt;
      &lt;li&gt;Database: Mysqlnd, pdo, pdo_mysql&lt;/li&gt;
      &lt;li&gt;Some general default: xsl, phar, posix, xml, zlib, ctype, curl, json.&lt;/li&gt;
      &lt;li&gt;&amp;amp; more depending on your configuration (for example if you want to use memcache for sessions).&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
April
15th,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues with Passbolt Pro?&lt;/p&gt;
    &lt;a href=&quot;mailto:contact@passbolt.com&quot; class=&quot;button primary&quot;&gt;Contact Pro support&lt;/a&gt;
    &lt;p&gt;or &lt;a href=&quot;https://community.passbolt.com&quot;&gt;ask the community&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Upgrade Passbolt docker from v1</title><link href="https://help.passbolt.com/hosting/upgrade/ce/upgrade-docker-ce.html" rel="alternate" type="text/html" title="Upgrade Passbolt docker from v1" /><published>2018-04-10T05:30:00+05:30</published><updated>2018-04-10T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/upgrade/ce/upgrade-docker-ce</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/ce/upgrade-docker-ce.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This tutorial covers the case where you want to upgrade your current docker installation of passbolt CE v1.x into passbolt CE v2.x.&lt;/p&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        &lt;strong&gt;Important:&lt;/strong&gt; Please take a full &lt;a href=&quot;/hosting/backup-v1&quot;&gt;backup&lt;/a&gt; of your passbolt before proceeding with the upgrade. Backup should include passbolt files as well as the database.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;h2 id=&quot;upgrade-from-v1610-debian&quot;&gt;Upgrade from v1.6.10-debian&lt;/h2&gt;

    &lt;p&gt;Passbolt v2 introduces several changes that are important to keep in mind when upgrading:&lt;/p&gt;

    &lt;h4 id=&quot;changes-environment-variables&quot;&gt;Changes: Environment variables&lt;/h4&gt;

    &lt;p&gt;The set of environment variables have changed and users should take some time to get familiar with the new ones. For example in case of the database env variables:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DB_USER is now DATASOURCES_DEFAULT_USERNAME
DB_HOST is now DATASOURCES_DEFAULT_HOST
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;There is a more detailed list in passbolt_docker &lt;a href=&quot;https://github.com/passbolt/passbolt_docker/blob/master/README.md&quot;&gt;README&lt;/a&gt; file.&lt;/p&gt;

    &lt;h4 id=&quot;changes-configuration-files&quot;&gt;Changes: Configuration files&lt;/h4&gt;

    &lt;p&gt;No more core.php, email.php or database.php.
Any user that does not want to use environment variables must configure passbolt using:&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt/config/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;Passbolt will look for for configuration values in &lt;code class=&quot;highlighter-rouge&quot;&gt;passbolt.php&lt;/code&gt;. Wether &lt;code class=&quot;highlighter-rouge&quot;&gt;passbolt.php&lt;/code&gt; does not exist or the configuration section is not defined on it, passbolt will then look for configuration details in default.php which relies on environment variables/default values.
Gpg config directory has changed slightly its path from:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt/app/Config/gpg/ to /var/www/passbolt/config/gpg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Gpg default server key file names also changed:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;serverkey.private.asc to serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;changes-www-user&quot;&gt;Changes: www user&lt;/h4&gt;

    &lt;p&gt;Passbolt container is now running under the www-data user&lt;/p&gt;

    &lt;h4 id=&quot;changes-images-directory&quot;&gt;Changes: images directory&lt;/h4&gt;

    &lt;p&gt;Path to the images directory is different:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt/app/webroot/img/public/images to /var/www/passbolt/webroot/img/public/images
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Users must also rename ProfileAvatar to Avatar directory inside public/images in order to see images in passbolt v2&lt;/p&gt;

    &lt;h4 id=&quot;changes-supervisor&quot;&gt;Changes: supervisor&lt;/h4&gt;

    &lt;p&gt;In order to manage the running process in passbolt container we introduced supervisord. Users are now able to restart passbolt container processes using:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;passbolt supervisorctl restart &amp;lt;php-fpm|nginx|cron&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Now that we have a better overview of the changes let’s start with the upgrading process!&lt;/p&gt;

    &lt;h3 id=&quot;backup-mysql-database&quot;&gt;Backup mysql database&lt;/h3&gt;

    &lt;p&gt;First of all is encouraged to backup all the relevant data that is:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Database&lt;/li&gt;
      &lt;li&gt;Images&lt;/li&gt;
      &lt;li&gt;Server public and private keys&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;You might want to check the detailed &lt;a href=&quot;/hosting/backup-v1&quot;&gt;backup list for v1&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;There are multiple ways to backup your database following there is an example using the passbolt container:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;passbolt mysqldump &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; &amp;lt;db_host&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                                 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; passbolt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                                 &lt;span class=&quot;nt&quot;&gt;-pP4ssb0lt&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                                 passbolt &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dump.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;This will output a dump.sql file on the host machine.&lt;/p&gt;

    &lt;h3 id=&quot;backup-images-directory&quot;&gt;Backup images directory&lt;/h3&gt;

    &lt;p&gt;If you are mounting the images directory using a bind mount just copy the host image directory in a safe location.
If you are using docker volumes to persist your images directory, or not persisting the images directory at all, you can execute the following to copy your images to the host machine.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;passbolt:/var/www/app/webroot/img/public public_images_backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;This will output a public_images_directory with the images stored in the passbolt container.&lt;/p&gt;

    &lt;h3 id=&quot;backup-gpg-keys&quot;&gt;Backup gpg keys&lt;/h3&gt;

    &lt;p&gt;As with the previous section you can proceed exactly the same with the gpg keys:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;passbolt:/var/www/app/Config/gpg/ gpg_keys_backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;This will output a gpg_keys_backup directory with the contents of the gpg configuration folder of passbolt.&lt;/p&gt;

    &lt;h2 id=&quot;getting-passbolt-container&quot;&gt;Getting passbolt container&lt;/h2&gt;

    &lt;p&gt;Passbolt containers follow the following tagging:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;version_number&amp;gt;-&amp;lt;build_number&amp;gt;-debian
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Nobody is perfect so we also provide a  &lt;em&gt;latest&lt;/em&gt; tag for Passbolt containers. Through all this documentation pages we make use of the latest tag so users will get the last version of passbolt.
However, it is recommended that users pull the tags pointing to specific passbolt versions when running in environments other than testing.&lt;/p&gt;

    &lt;p&gt;Get passbolt  latest docker container:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker pull passbolt/passbolt:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;upgrade-using-latest-v1-version-1610&quot;&gt;Upgrade using latest v1 version (1.6.10)&lt;/h2&gt;

    &lt;p&gt;Passbolt  v2 will run the database migrations if needed when starting up. Users just need to provide the gpg keys, configuration files/env variables and images.
Following some examples:&lt;/p&gt;

    &lt;h3 id=&quot;using-host-bind-mounts&quot;&gt;Using host bind mounts&lt;/h3&gt;

    &lt;p&gt;Users that use host bind mounts from host machine into docker file must adjust paths of the mounted files:&lt;/p&gt;

    &lt;p&gt;In the following snippet:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;passbolt_images_dir: path to a host directory that contains passbolt images Avatar directory.&lt;/li&gt;
      &lt;li&gt;gpg_host_dir: path to a host directory that contains serverkey.asc and serverkey_private.asc&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; passbolt &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;passbolt_images_dir&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/webroot/img &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;gpg_host_dir&amp;gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/gpg &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;APP_FULL_BASE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://mydomain.com &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             passbolt/passbolt:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;using-docker-volumes&quot;&gt;Using docker volumes&lt;/h3&gt;

    &lt;p&gt;Users that use docker volumes should adjust their volumes paths.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; passbolt &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;passbolt_images_volume&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/webroot/img &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;gpg_keys_volume&amp;gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/gpg &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;APP_FULL_BASE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://mydomain.com &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             passbolt/passbolt:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
April
10th,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when installing passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;tldr&quot;&gt;
    &lt;h4 class=&quot;visuallyhidden&quot;&gt;Available on docker hub&lt;/h4&gt;
    &lt;p&gt;
        &lt;a href=&quot;https://hub.docker.com/r/passbolt/passbolt/&quot; target=&quot;_blank&quot; rel=&quot;noopener nofollow&quot;&gt;
            &lt;img alt=&quot;Docker Logo&quot; src=&quot;/assets/img/third_party/docker_small_h.png&quot; style=&quot;&quot; /&gt;
        &lt;/a&gt;
    &lt;/p&gt;
    &lt;a href=&quot;https://hub.docker.com/r/passbolt/passbolt/&quot; class=&quot;primary button&quot;&gt;
        Get passbolt container!
    &lt;/a&gt;
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;We highly recommend that you install https on your server. You can get a free SSL certificate with the let's encrypt initiative.&lt;/p&gt;
    
    &lt;a href=&quot;https://letsencrypt.org/&quot; class=&quot;button &quot;&gt;let's encrypt!&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Using Passbolt pro virtual machine appliance</title><link href="https://help.passbolt.com/hosting/install/pro/vm.html" rel="alternate" type="text/html" title="Using Passbolt pro virtual machine appliance" /><published>2018-04-10T05:30:00+05:30</published><updated>2018-04-10T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/install/pro/vm</id><content type="html" xml:base="https://help.passbolt.com/hosting/install/pro/vm.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;h2 id=&quot;description&quot;&gt;Description&lt;/h2&gt;

    &lt;p&gt;Passbolt Pro provides a virtual appliance in OVA format. Users can import this appliance on their private virtualization platform and start enjoying Passbolt Pro.
The VM includes the following software:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Debian 9.4&lt;/li&gt;
      &lt;li&gt;Nginx&lt;/li&gt;
      &lt;li&gt;Php-fpm&lt;/li&gt;
      &lt;li&gt;Mariadb&lt;/li&gt;
      &lt;li&gt;Passbolt Pro preinstalled&lt;/li&gt;
      &lt;li&gt;certbot&lt;/li&gt;
      &lt;li&gt;haveged to fill the entropy pool faster&lt;/li&gt;
      &lt;li&gt;Scripts to easy managing SSL setup of the VM&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;getting-passbolt-pro-vm&quot;&gt;Getting Passbolt Pro VM&lt;/h2&gt;

    &lt;p&gt;Download the ova and the SHA512SUM.txt:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.passbolt.com/pro/download/vm/debian/latest&quot;&gt;Passbolt Pro VM&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.passbolt.com/pro/download/vm/debian/latest-checksum&quot;&gt;SHA512SUM.txt&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;Import the ova file using virtualbox, vmware or any other platform that supports OVA files.&lt;/p&gt;

    &lt;p&gt;Once imported into users should be able to boot the VM and just point to the VM ip address with their web browser to initiate the passbolt install process.
However it is encouraged that users log in the VM and start the SSL setup proces.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;VM login credentials:
username: passbolt
password: admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;ssl-setup-process&quot;&gt;SSL setup process:&lt;/h2&gt;

    &lt;p&gt;Passbolt Pro provides a set of ssl scripts to easily setup SSL. This scripts are located in:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/home/passbolt/passbolt_ssl_setup/passbolt_pro_debian_ssl_installer.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Executing the following command the script will guide you through the SSL setup:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /home/passbolt/passbolt_ssl_setup/passbolt_pro_debian_ssl_installer.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
April
10th,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues with Passbolt Pro?&lt;/p&gt;
    &lt;a href=&quot;mailto:contact@passbolt.com&quot; class=&quot;button primary&quot;&gt;Contact Pro support&lt;/a&gt;
    &lt;p&gt;or &lt;a href=&quot;https://community.passbolt.com&quot;&gt;ask the community&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Install passbolt from scratch on Debian 9 (Stretch)</title><link href="https://help.passbolt.com/hosting/install/ce/debian-9-stretch.html" rel="alternate" type="text/html" title="Install passbolt from scratch on Debian 9 (Stretch)" /><published>2018-04-09T05:30:00+05:30</published><updated>2018-04-09T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/install/ce/from-source</id><content type="html" xml:base="https://help.passbolt.com/hosting/install/ce/debian-9-stretch.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;h2 id=&quot;system-requirements&quot;&gt;System requirements&lt;/h2&gt;

    &lt;p&gt;Spin up a new fresh server with Debian 9 (Stretch). Make sure that it is up-to-date.&lt;/p&gt;

    &lt;h2 id=&quot;installation-steps&quot;&gt;Installation steps&lt;/h2&gt;

    &lt;h3 id=&quot;base-packages&quot;&gt;1. Base packages&lt;/h3&gt;
    &lt;p&gt;No need to install any particular package such as the webserver (apache) during the setup. Let’s stick to the bare minimum for now, as we will do the rest manually.&lt;/p&gt;

    &lt;p&gt;Since we will need administrator privileges to perform most of the steps, you could either setup sudo for your default user, or log in the terminal as root.&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We can install some basic utilities: Git, composer, unzip, make, the linux kernel headers and a compiler, as will all be needed later on.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;make git-core composer unzip g++ linux-headers-amd64 &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;database-installation&quot;&gt;2. Database installation&lt;/h3&gt;
    &lt;p&gt;Then, we can install the database server. We will use mariadb here, but you could also use mysql.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mariadb-server &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Let’s make sure that the database is started&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;By default, MariaDB / MySQL is installed with basic security, and no root password. Let’s fix this.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql_secure_installation
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Answer the questions and set a strong root password for the db.&lt;/p&gt;

    &lt;p&gt;Let’s now create a specific passbolt user and database.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; create database passbolt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; create user passbolt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; grant all on passbolt.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; to &lt;span class=&quot;s1&quot;&gt;'passbolt'&lt;/span&gt;@&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt; identified by &lt;span class=&quot;s1&quot;&gt;'strong_db_password'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; flush privileges&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; quit&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;webserver-installation-apache2&quot;&gt;3. Webserver installation (apache2)&lt;/h3&gt;
    &lt;p&gt;Next we will want to install the apache webserver that will serve our php application.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;apache2 &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Passbolt needs the mod_rewrite module to function properly.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;a2enmod rewrite
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We can see if this worked by opening up the web browser and going to the url: http://localhost (or whatever hostname / ip used by your machine). 
By default apache stores the web pages in /var/www/html so we can see and edit the default html page in this directory if needed.&lt;/p&gt;

    &lt;h3 id=&quot;php-installation&quot;&gt;4. PHP installation&lt;/h3&gt;
    &lt;p&gt;Now let’s install php 7 and its dependencies. By default the command line interface (php5-cli) and the apache mod for php (libapache2-mod-php5) will be also installed as dependencies. We will need them later on.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;php7.0 php7.0-cli php7.0-common libapache2-mod-php7.0 php7.0-json php7.0-readline php7.0-mysqlnd libonig4 libqdbm14 &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Passbolt needs some extra dependencies to run properly:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;php7.0-gd php7.0-intl php7.0-simplexml php7.0-curl php7.0-dom php7.0-mbstring &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Passbolt needs GnuPG and it corresponding php module to run.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;libgpgme11-dev php7.0-gnupg &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You will need to restart your apache server for the changes to take place.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart apache2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;virtual-host-config&quot;&gt;5. Virtual host config&lt;/h3&gt;
    &lt;p&gt;For apache to work with passbolt we need to edit the virtual host configuration file to add the passbolt folder and rewrite rules.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano /etc/apache2/sites-enabled/000-default.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;This is what a minimal configuration without ssl looks like (we’ll get to the ssl part later). Of course you will need to replace your administrator email address (ServerAdmin setting) and server name (ServerName setting).&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;VirtualHost *:80&amp;gt;
    ServerAdmin webmaster@localhost
    ServerName passbolt.dev

    DocumentRoot /var/www/passbolt

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    &amp;lt;Directory /var/www/passbolt&amp;gt;
        Options FollowSymLinks
        AllowOverride All
        Require all granted
    &amp;lt;/Directory&amp;gt;
&amp;lt;/VirtualHost&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;h3 id=&quot;domain-name-setup&quot;&gt;6. Domain name setup&lt;/h3&gt;
    &lt;p&gt;For the sake of keeping this demonstration short we will use passbolt.dev as domain name
(we added the IP to domain name mapping with a manual entry in the /etc/hosts file after a quick lookup on ifconfig).&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano /etc/hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Add this line to the file&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;127.0.0.1 passbolt.dev
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Of course, replace 127.0.0.1 by whichever ip is used by your host.&lt;/p&gt;

    &lt;h3 id=&quot;download-passbolt&quot;&gt;7. Download passbolt&lt;/h3&gt;
    &lt;p&gt;In the web server configuration file, we are pointing to &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/passbolt&lt;/code&gt; but obviously it does not exist yet! 
Let’s create it, by cloning passbolt official repository. This way we can pull new releases easily in the future.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/passbolt/passbolt_api.git ./passbolt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;generate-an-openpgp-key&quot;&gt;8. Generate an OpenPGP key&lt;/h3&gt;
    &lt;p&gt;Passbolt API uses an OpenPGP key for the server in order to authenticate and sign the outgoing JSON requests.&lt;/p&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        &lt;strong&gt;Note:&lt;/strong&gt; Running gpg –gen-key on a virtual machine can take a while because /dev/random does not have enough “randomness” aka entropy. You can speed up the gpg key creation with the &lt;strong&gt;haveged&lt;/strong&gt; package to improve the entropy generation :

    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Only in case of container or VM&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;haveged &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start haveged
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Now generate an OpenPGP key&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Important: Currently php-gnupg does not support keys with a passphrase so you will need to leave that field empty.&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--gen-key&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; if you do not run this command as &lt;code class=&quot;highlighter-rouge&quot;&gt;www-data&lt;/code&gt; the result will be stored in &lt;code class=&quot;highlighter-rouge&quot;&gt;/root/.gnupg&lt;/code&gt;. Thankfully passbolt does import the keys at runtime into the &lt;code class=&quot;highlighter-rouge&quot;&gt;www-data&lt;/code&gt; keyring if it is not already present.&lt;/p&gt;

    &lt;p&gt;It’s a good idea to fill in the details properly and not press enter frantically. Make sure you have decent name and email for the key. This will come in handy to identify and verify it down the line.&lt;/p&gt;

    &lt;p&gt;After creating the key &lt;strong&gt;make sure you note down the fingerprint&lt;/strong&gt;, it will be requested later in the install process.
You can get the server key fingerprint as follows:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--list-keys&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--fingerprint&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-B&lt;/span&gt; 2 &lt;span class=&quot;s1&quot;&gt;'SERVER_KEY@EMAIL.TEST'&lt;/span&gt;
pub   2048R/28EEB539 2018-04-18
      Key fingerprint &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 480E 9564 0F27 6562 39D6  7BF5 8AB6 8641 28EE B539
uid                  firstname lastname &amp;lt;SERVER_KEY@EMAIL.TEST&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Copy the public and private keys to the passbolt config location:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--armor&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--export-secret-keys&lt;/span&gt; SERVER_KEY@EMAIL.TEST &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /var/www/passbolt/config/gpg/serverkey_private.asc
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--armor&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--export&lt;/span&gt; SERVER_KEY@EMAIL.TEST &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /var/www/passbolt/config/gpg/serverkey.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We don’t want those keys to be readable by anyone, except the webserver.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;640 /var/www/passbolt/config/gpg/serverkey&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;initialize-the-webserver-gpg-keyring&quot;&gt;9. Initialize the webserver gpg keyring&lt;/h3&gt;
    &lt;p&gt;In order for passbolt authentication to work your server key needs to be in the keyring used by the web server.
It is likely that there is none, so you can create one by interacting with gpg with the web server user&lt;/p&gt;

    &lt;p&gt;In debian 9, the home directory of the web server user www-data is /var/www.&lt;/p&gt;

    &lt;p&gt;We need to give ownership of this folder to www-data , since it is not there by default.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;www-data:www-data /var/www
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We create the keyring for the webserver:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;gpg --list-keys&quot;&lt;/span&gt; www-data
gpg: directory &lt;span class=&quot;s1&quot;&gt;'/var/www/.gnupg'&lt;/span&gt; created
gpg: keybox &lt;span class=&quot;s1&quot;&gt;'/var/www/.gnupg/pubring.kbx'&lt;/span&gt; created
gpg: /var/www/.gnupg/trustdb.gpg: trustdb created
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;set-passbolt-file-permissions&quot;&gt;9. Set passbolt file permissions&lt;/h3&gt;
    &lt;p&gt;We need to set the right permissions on the passbolt files. It should belong to the same owner as the webserver.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt;  www-data:www-data /var/www/passbolt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www/passbolt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Important:&lt;/strong&gt; For the following steps, we’ll also need to use the same user as the one running the webserver. In our case (apache), it is www-data.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/bash www-data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;install-the-dependencies&quot;&gt;10. Install the dependencies&lt;/h3&gt;
    &lt;p&gt;The project dependencies such as the plugin to manage the images, emails, etc. are not included anymore
in the code on the official repository. Fret not, composer will manage this for us.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;composer &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;create-a-passbolt-configuration-file&quot;&gt;11. Create a passbolt configuration file&lt;/h3&gt;
    &lt;p&gt;Everything is located in one configuration file called &lt;code class=&quot;highlighter-rouge&quot;&gt;config/passbolt.php&lt;/code&gt;.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;config/passbolt.default.php config/passbolt.php
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano config/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You will need to set at least the following:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Application full base url&lt;/li&gt;
      &lt;li&gt;Database configuration&lt;/li&gt;
      &lt;li&gt;Server OpenPGP key fingerprint (you noted it down before)&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;Ignore the email configuration for now. We will take care of it later.&lt;/p&gt;

    &lt;p&gt;For now, we will also deactivate the force_ssl parameter for the sake of having a functional passbolt
quickly. We’ll activate ssl later.&lt;/p&gt;

    &lt;p&gt;The sections of your configuration file should look similar to this:&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[
    'App' =&amp;gt; [
        'fullBaseUrl' =&amp;gt; 'http://passbolt.dev',
    ],

    // Database configuration.
    'Datasources' =&amp;gt; [
        'default' =&amp;gt; [
            'host' =&amp;gt; 'localhost',
            'username' =&amp;gt; 'passbolt',
            'password' =&amp;gt; 'your_password',
            'database' =&amp;gt; 'passbolt',
        ],
    ],
    'passbolt' =&amp;gt; [
        'ssl' =&amp;gt; [
            'force' =&amp;gt; false,
        ],
        'gpg' =&amp;gt; [ 
            // Main server key.
            'serverKey' =&amp;gt; [
                // Server private key fingerprint.
                'fingerprint' =&amp;gt; '1C765F5273EC9AF56300BC6F6C76DA6B9F23C8BB',
                //'public' =&amp;gt; CONFIG . 'gpg' . DS . 'serverkey.asc',
                //'private' =&amp;gt; CONFIG . 'gpg' . DS . 'serverkey_private.asc',
            ],
        ],
    ],
]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;For now, do not forget to add &lt;code class=&quot;highlighter-rouge&quot;&gt;ssl.force =&amp;gt; false&lt;/code&gt; as seen above, or passbolt will redirect all your connections to a https socket, which will not work since it is not yet configured.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'ssl' =&amp;gt; [
    'force' =&amp;gt; false,
],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You can also set your configuration using environment variables.
Check &lt;code class=&quot;highlighter-rouge&quot;&gt;config/default.php&lt;/code&gt; to get the names of the environment variables.&lt;/p&gt;

    &lt;h3 id=&quot;run-the-install-script&quot;&gt;12. Run the install script&lt;/h3&gt;
    &lt;p&gt;Let’s install passbolt tables and data in the database.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake passbolt &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;The install script will ask you to create an admin user. Enter your first name, last name and email. In return, the script will
provide you with an activation link that you will user later to activate and configure your user. You can go to this url now or later, but we
recommend that you configure SSL before.&lt;/p&gt;

    &lt;p&gt;Optionally you can also run the health check to see if everything is fine.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake passbolt healthcheck
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You should see a majority of green ok. However, some SSL related alerts should still appear.&lt;/p&gt;

    &lt;h3 id=&quot;its-running&quot;&gt;13. It’s running&lt;/h3&gt;
    &lt;p&gt;At this stage, passbolt is running as it should, but https is still missing. It is strongly recommended
that you configure https before using passbolt. We will go through it in the next section, as well as the emails configuration.&lt;/p&gt;

    &lt;h2 id=&quot;going-further&quot;&gt;Going further&lt;/h2&gt;

    &lt;h3 id=&quot;setup-the-emails&quot;&gt;1. Setup the emails&lt;/h3&gt;
    &lt;p&gt;For passbolt to be able to send emails, you must first configure properly the “EmailTransport” and “Email” section in the 
&lt;code class=&quot;highlighter-rouge&quot;&gt;config/passbolt.php&lt;/code&gt; file to match your provider smtp details.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// Email configuration.
    'EmailTransport' =&amp;gt; [
        'default' =&amp;gt; [
            'host' =&amp;gt; 'localhost',
            'port' =&amp;gt; 25,
            'username' =&amp;gt; 'user',
            'password' =&amp;gt; 'password',
            // Is this a secure connection? true if yes, null if no.
            'tls' =&amp;gt; null,
            //'timeout' =&amp;gt; 30,
            //'client' =&amp;gt; null,
            //'url' =&amp;gt; null,
        ],
    ],
    'Email' =&amp;gt; [
        'default' =&amp;gt; [
            // Defines the default name and email of the sender of the emails.
            'from' =&amp;gt; ['passbolt@your_organization.com' =&amp;gt; 'Passbolt'],
            //'charset' =&amp;gt; 'utf-8',
            //'headerCharset' =&amp;gt; 'utf-8',
        ],
    ],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;To send a test email and debug your smtp settings, you can use the following command:&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake passbolt send_test_email
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;When an email is sent, it is first placed in a queue that needs to be processed by the following shell.&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake EmailQueue.sender
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;In order to have your emails sent automatically, you can add a cron call to the script so the emails will be sent every minute. 
Add the following line to you crontab:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; su &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/var/www/passbolt/bin/cake EmailQueue.sender &amp;gt;&amp;gt; /var/log/passbolt.log&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/bash www-data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;configure-https&quot;&gt;2. Configure https&lt;/h3&gt;
    &lt;p&gt;It is recommended to use https with passbolt (and, well, pretty much &lt;a href=&quot;https://www.eff.org/encrypt-the-web&quot;&gt;everything&lt;/a&gt;). 
To setup SSL we need a certificate. Here for the sake of brevity we will create a self-signed certificate. 
Of course you are free to use a &lt;a href=&quot;https://letsencrypt.org/getting-started/&quot;&gt;proper free certificate&lt;/a&gt; and tidy up the server supported cypher suites.&lt;/p&gt;

    &lt;p&gt;In the following steps, we’ll generate a self signed certificate and configure apache and passbolt to use https.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;a. Generate the self signed certificate&lt;/strong&gt;&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;openssl req &lt;span class=&quot;nt&quot;&gt;-new&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-newkey&lt;/span&gt; rsa:4096 &lt;span class=&quot;nt&quot;&gt;-days&lt;/span&gt; 365 &lt;span class=&quot;nt&quot;&gt;-nodes&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x509&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-subj&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/C=FR/ST=Denial/L=Springfield/O=Dis/CN=passbolt.dev&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-keyout&lt;/span&gt; /etc/ssl/certs/passbolt.key &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; /etc/ssl/certs/passbolt.crt

Generating a 4096 bit RSA private key
................++
...++
writing new private key to &lt;span class=&quot;s1&quot;&gt;'/etc/ssl/certs/passbolt.key'&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;b. Make sure the certificate is readable by apache&lt;/strong&gt;&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;root:www-data /etc/ssl/certs/passbolt.crt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;root:www-data /etc/ssl/certs/passbolt.key
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;640 /etc/ssl/certs/passbolt.crt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;640 /etc/ssl/certs/passbolt.key
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Enable SSL apache module and site&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;a2enmod ssl
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;a2enmod headers
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;a2ensite default-ssl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;c. Configure virtual host&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;Let’s add the rewrite and SSL rules and certificates.&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano /etc/apache2/sites-enabled/default-ssl.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Your file should look like this:&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;IfModule mod_ssl.c&amp;gt;
    &amp;lt;VirtualHost _default_:443&amp;gt;
        ServerAdmin webmaster@localhost
        ServerName passbolt.dev

        DocumentRoot /var/www/passbolt

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        SSLEngine on
        SSLCertificateFile /etc/ssl/certs/passbolt.crt
        SSLCertificateKeyFile /etc/ssl/certs/passbolt.key
 
        &amp;lt;Directory /var/www/passbolt&amp;gt;
            Options FollowSymLinks
            AllowOverride All
            Require all granted
        &amp;lt;/Directory&amp;gt;
    
        &amp;lt;FilesMatch “\.(php)$”&amp;gt;
            SSLOptions +StdEnvVars
        &amp;lt;/FilesMatch&amp;gt;

        BrowserMatch “MSIE [2–6]” \
          nokeepalive ssl-unclean-shutdown \
          downgrade-1.0 force-response-1.0
        BrowserMatch “MSIE [17–9]” ssl-unclean-shutdown

    &amp;lt;/VirtualHost&amp;gt;
&amp;lt;/IfModule&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;d. Restart Apache&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl reload apache2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;e. Force SSL in passbolt configuration&lt;/strong&gt;
We’ll need to change the passbolt configuration to make him use https instead of http,
and force the redirection to https:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano /var/www/passbolt/config/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Set fullBaseUrl to https&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'App' =&amp;gt; [
    'fullBaseUrl' =&amp;gt; 'https://passbolt.dev',
],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Set ssl.force config parameter to true, instead of false. You can also remove the line as it will be set to true by default.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'ssl' =&amp;gt; [
    'force' =&amp;gt; true,
],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;That’s it! Passbolt is now ready to be used with https.&lt;/p&gt;

    &lt;p&gt;If you have already done the setup of your user, you will notice that passbolt tells you that the plugin is not configured to work with this domain. This is normal since it was already configured to work with http, and not https.&lt;/p&gt;

    &lt;p&gt;That’s not an issue, you can fix this easily by clicking on “recover an existing account”&lt;/p&gt;

    &lt;h2 id=&quot;thats-it&quot;&gt;That’s it&lt;/h2&gt;
    &lt;p&gt;Do let us know if you run into problems following this tutorial on the &lt;a href=&quot;support forum&quot;&gt;https://community.passbolt.com/c/installation-issues&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Thank you for trying out Passbolt CE!&lt;/p&gt;

    &lt;h3 id=&quot;troubleshooting&quot;&gt;Troubleshooting&lt;/h3&gt;

    &lt;p&gt;Here are some frequently asked questions related to passbolt installation:&lt;/p&gt;
    &lt;ul&gt;
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
            
                
    &lt;li&gt;
        &lt;a href=&quot;/faq/hosting/why-unsafe&quot;&gt;Why do I see an unsafe mode banner in the footer?&lt;/a&gt;
    &lt;/li&gt;
                
            
        
    
    
    
        
            
                
    &lt;li&gt;
        &lt;a href=&quot;/faq/hosting/why-email-not-sent&quot;&gt;Why are my emails not being sent?&lt;/a&gt;
    &lt;/li&gt;
                
            
        
    
    
    
        
    
    
    
    
    
        
    
    
    
        
    
    
    
    
    
    
    
    
    
    
    
    
    
    
&lt;/ul&gt;

    &lt;p&gt;Feel free to ask for help on the &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot;&gt;community forum&lt;/a&gt;.&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
April
9th,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when installing passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;&lt;strong&gt;Don't want the hassle of a manual installation?&lt;/strong&gt; Passbolt Pro comes with out of the box install scripts and a ready-to-use VM.&lt;/p&gt;
    &lt;a href=&quot;https://www.passbolt.com/pricing/pro&quot; class=&quot;button primary&quot;&gt;Get Passbolt Pro&lt;/a&gt;

&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Install passbolt from scratch on CentOS 7</title><link href="https://help.passbolt.com/hosting/install/ce/centos-7.html" rel="alternate" type="text/html" title="Install passbolt from scratch on CentOS 7" /><published>2018-04-09T05:30:00+05:30</published><updated>2018-04-09T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/install/ce/from-source</id><content type="html" xml:base="https://help.passbolt.com/hosting/install/ce/centos-7.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;h2 id=&quot;system-requirements&quot;&gt;System requirements&lt;/h2&gt;

    &lt;p&gt;Spin up a new fresh server with CentOS 7. Make sure that it is up-to-date.&lt;/p&gt;

    &lt;h2 id=&quot;installation-steps&quot;&gt;Installation steps&lt;/h2&gt;

    &lt;h3 id=&quot;base-packages&quot;&gt;1. Base packages&lt;/h3&gt;
    &lt;p&gt;No need to install any particular package such as the webserver (nginx) during the initial setup. Let’s stick to the bare minimum for now, as we will do the rest manually.&lt;/p&gt;

    &lt;p&gt;Since we will need administrator privileges to perform most of the steps, you could either setup sudo for your default user, or log in the terminal as root.&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Let’s first update our yum database and enable EPEL repositories to 
install all the required passbolt components:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum update
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;yum-utils epel-release
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;We also install remi’s repositories which will be helpful for PHP 7.2&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'http://rpms.remirepo.net/enterprise/remi-release-7.rpm'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum-config-manager &lt;span class=&quot;nt&quot;&gt;--enable&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'remi-php72'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Finally, we can install some basic utilities:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;gcc is required to build php-gnupg extension throuhg PECL.&lt;/li&gt;
      &lt;li&gt;git will be required to clone passbolt source code&lt;/li&gt;
      &lt;li&gt;policycoreutils-python will install some binaries to easily manage selinux policies such as semanage.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;unzip wget composer policycoreutils-python git gcc 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;database-installation&quot;&gt;2. Database installation&lt;/h3&gt;
    &lt;p&gt;Then, we can install the database server. We will use mariadb here, but you could also use mysql.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;mariadb-server &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Let’s make sure that the database is started&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;By default, MariaDB / MySQL is installed with basic security, and no root password. Let’s fix this.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql_secure_installation
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Answer the questions and set a strong root password for the db.&lt;/p&gt;

    &lt;p&gt;Let’s now create a specific passbolt user and database.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; create database passbolt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; create user passbolt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; grant all on passbolt.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; to &lt;span class=&quot;s1&quot;&gt;'passbolt'&lt;/span&gt;@&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt; identified by &lt;span class=&quot;s1&quot;&gt;'strong_db_password'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; flush privileges&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; quit&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;webserver-installation-nginx&quot;&gt;3. Webserver installation (Nginx)&lt;/h3&gt;
    &lt;p&gt;Next we will want to install the Nginx webserver that will serve our php application.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;nginx &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We can see if this worked by opening up the web browser and going to the url: http://localhost (or whatever hostname / ip used by your machine). 
By default nginx stores the web pages in /usr/share/nginx/html/ so we can see and edit the default html page in this directory if needed.&lt;/p&gt;

    &lt;h3 id=&quot;php-installation&quot;&gt;4. PHP installation&lt;/h3&gt;
    &lt;p&gt;Now let’s install php 7 and its dependencies. By default the command line interface (php5-cli) will be also installed as dependencies. We will need them later on.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;php-intl php-gd php-mysql php-mcrypt php-pear php-devel php-mbstring php-fpm gpgme-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Install php-fpm&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; php-fpm
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;php-fpm
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start php-fpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We will be making use of the default nginx user to run both nginx and php-fpm. FPM out of the box uses the apache user but it is easy to change:&lt;/p&gt;

    &lt;p&gt;Edit /etc/php-fpm.d/www.conf with your preferred editor and modify the user/group configuration parameter to ‘nginx’:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi /etc/php-fpm.d/www.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;user = nginx
group = nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We also need to change the default group owner of the default php session directory so that it belongs to nginx.&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;chgrp &lt;/span&gt;nginx /var/lib/php/session
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Passbolt needs GnuPG and it corresponding php module to run&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pecl &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;gnupg
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;extension=gnupg.so&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/php.d/gnupg.ini
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You will need to restart your nginx server, and php-fpm for the changes to take place.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart nginx
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart php-fpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;web-server-configuration&quot;&gt;5. Web server configuration&lt;/h3&gt;
    &lt;p&gt;For nginx to work with passbolt we need to edit its configuration file to point to the passbolt folder (which will be created later) and rewrite rules.
We also consider that passbolt will be reachable on the hostname &lt;code class=&quot;highlighter-rouge&quot;&gt;passbolt.dev&lt;/code&gt;.&lt;/p&gt;

    &lt;p&gt;For now, we will configure it without SSL for the sake of keeping it simple.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi /etc/nginx/conf.d/default.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Below is an example of configuration you can use in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/nginx/conf.d/default.conf&lt;/code&gt;&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
  listen 80;
  server_name passbolt.dev;
  client_body_buffer_size     100K;
  client_header_buffer_size   1k;
  client_max_body_size        100k;
  client_body_timeout   10;
  client_header_timeout 10;
  keepalive_timeout     5 5;
  send_timeout          10;
  root /var/www/passbolt/webroot;

  location / {
    try_files $uri $uri/ /index.php?$args;
    index index.php;
  }
  
  location ~ \.php$ {
    fastcgi_index           index.php;
    fastcgi_pass            127.0.0.1:9000;
    fastcgi_split_path_info ^(.+\.php)(.+)$;
    include                 fastcgi_params;
    fastcgi_param           SCRIPT_FILENAME $document_root$fastcgi_script_name;
    fastcgi_param           SERVER_NAME $http_host;
  }
  
  location ~* \.(jpe?g|woff|woff2|ttf|gif|png|bmp|ico|css|js|json|pdf|zip|htm|html|docx?|xlsx?|pptx?|txt|wav|swf|svg|avi|mp\d)$ {
    access_log off;
    log_not_found off;
    try_files $uri /webroot/$uri /index.php?$args;
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;domain-name-setup&quot;&gt;6. Domain name setup&lt;/h3&gt;
    &lt;p&gt;For the sake of keeping this demonstration short we will use passbolt.dev as domain name
(we added the IP to domain name mapping with a manual entry in the /etc/hosts file after a quick lookup on ifconfig).&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi /etc/hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Add this line to the file&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;127.0.0.1 passbolt.dev
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Of course, replace 127.0.0.1 by whichever ip is used by your host.&lt;/p&gt;

    &lt;h3 id=&quot;download-passbolt-source-code&quot;&gt;7. Download passbolt source code&lt;/h3&gt;
    &lt;p&gt;In the web server configuration file, we are pointing to &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/passbolt&lt;/code&gt; but obviously it does not exist yet! 
Let’s create it, by cloning passbolt official repository. This way we can pull new releases easily in the future.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/passbolt/passbolt_api.git ./passbolt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;generate-an-openpgp-key&quot;&gt;8. Generate an OpenPGP key&lt;/h3&gt;
    &lt;p&gt;Passbolt API uses an OpenPGP key for the server in order to authenticate and sign the outgoing JSON requests.&lt;/p&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        &lt;strong&gt;Note:&lt;/strong&gt; Running gpg –gen-key on a virtual machine can take a while because /dev/random does not have enough “randomness” aka entropy. You can speed up the gpg key creation with the &lt;strong&gt;haveged&lt;/strong&gt; package to improve the entropy generation :

    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Only in case of container or VM&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;haveged &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl start haveged
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Now generate an OpenPGP key&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Important: Currently php-gnupg does not support keys with a passphrase so you will need to leave that field empty.&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--gen-key&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; if you do not run this command as &lt;code class=&quot;highlighter-rouge&quot;&gt;nginx&lt;/code&gt; the result will be stored in &lt;code class=&quot;highlighter-rouge&quot;&gt;/root/.gnupg&lt;/code&gt;. Thankfully passbolt does import the keys at runtime into the &lt;code class=&quot;highlighter-rouge&quot;&gt;nginx&lt;/code&gt; keyring if it is not already present.&lt;/p&gt;

    &lt;p&gt;It’s a good idea to fill in the details properly and not press enter frantically. Make sure you have decent name and email for the key. This will come in handy to identify and verify it down the line.&lt;/p&gt;

    &lt;p&gt;After creating the key &lt;strong&gt;make sure you note down the fingerprint&lt;/strong&gt;, it will be requested later in the install process.
You can get the server key fingerprint as follows:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--list-keys&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--fingerprint&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-B&lt;/span&gt; 2 &lt;span class=&quot;s1&quot;&gt;'SERVER_KEY@EMAIL.TEST'&lt;/span&gt;
pub   2048R/28EEB539 2018-04-18
      Key fingerprint &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 480E 9564 0F27 6562 39D6  7BF5 8AB6 8641 28EE B539
uid                  firstname lastname &amp;lt;SERVER_KEY@EMAIL.TEST&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Copy the public and private keys to the passbolt config location:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--armor&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--export-secret-keys&lt;/span&gt; SERVER_KEY@EMAIL.TEST &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /var/www/passbolt/config/gpg/serverkey_private.asc
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gpg &lt;span class=&quot;nt&quot;&gt;--armor&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--export&lt;/span&gt; SERVER_KEY@EMAIL.TEST &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /var/www/passbolt/config/gpg/serverkey.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;We don’t want those keys to be readable by anyone, except the webserver.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;640 /var/www/passbolt/config/gpg/serverkey&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;initialize-the-webserver-gpg-keyring&quot;&gt;9. Initialize the webserver gpg keyring&lt;/h3&gt;
    &lt;p&gt;In order for passbolt authentication to work your server key needs to be in the keyring used by the web server.
It is likely that there is none, so you can create one by interacting with gpg with the web server user&lt;/p&gt;

    &lt;p&gt;In centos 7, the home directory of the web server user nginx is /var/lib/nginx.&lt;/p&gt;

    &lt;p&gt;We create the keyring for the webserver:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;gpg --list-keys&quot;&lt;/span&gt; nginx
gpg: directory &lt;span class=&quot;s1&quot;&gt;'/var/lib/nginx/.gnupg'&lt;/span&gt; created
gpg: keybox &lt;span class=&quot;s1&quot;&gt;'/var/lib/nginx/.gnupg/pubring.kbx'&lt;/span&gt; created
gpg: /var/lib/nginx/.gnupg/trustdb.gpg: trustdb created
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;set-passbolt-file-permissions&quot;&gt;10. Set passbolt file permissions&lt;/h3&gt;
    &lt;p&gt;We need to set the right permissions on the passbolt files. It should belong to the same owner as the webserver.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt;  nginx:nginx /var/www/passbolt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www/passbolt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Important:&lt;/strong&gt; For the following steps, we’ll also need to use the same user as the one running the webserver. In our case (nginx), it is nginx.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/bash nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;install-the-dependencies&quot;&gt;11. Install the dependencies&lt;/h3&gt;
    &lt;p&gt;The project dependencies such as the plugin to manage the images, emails, etc. are not included anymore
in the code on the official repository. Fret not, composer will manage this for us.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;composer &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;create-a-passbolt-configuration-file&quot;&gt;12. Create a passbolt configuration file&lt;/h3&gt;
    &lt;p&gt;Everything is located in one configuration file called &lt;code class=&quot;highlighter-rouge&quot;&gt;config/passbolt.php&lt;/code&gt;.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;config/passbolt.default.php config/passbolt.php
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi config/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You will need to set at least the following:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Application full base url&lt;/li&gt;
      &lt;li&gt;Database configuration&lt;/li&gt;
      &lt;li&gt;Server OpenPGP key fingerprint (you noted it down before)&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;Ignore the email configuration for now. We will take care of it later.&lt;/p&gt;

    &lt;p&gt;For now, we will also deactivate the force_ssl parameter for the sake of having a functional passbolt
quickly. We’ll activate ssl later.&lt;/p&gt;

    &lt;p&gt;The sections of your configuration file should look similar to this:&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[
    'App' =&amp;gt; [
        'fullBaseUrl' =&amp;gt; 'http://passbolt.dev',
    ],

    // Database configuration.
    'Datasources' =&amp;gt; [
        'default' =&amp;gt; [
            'host' =&amp;gt; 'localhost',
            'username' =&amp;gt; 'passbolt',
            'password' =&amp;gt; 'your_password',
            'database' =&amp;gt; 'passbolt',
        ],
    ],
    'passbolt' =&amp;gt; [
        'ssl' =&amp;gt; [
            'force' =&amp;gt; false,
        ],
        'gpg' =&amp;gt; [ 
            // Main server key.
            'serverKey' =&amp;gt; [
                // Server private key fingerprint.
                'fingerprint' =&amp;gt; '1C765F5273EC9AF56300BC6F6C76DA6B9F23C8BB',
                //'public' =&amp;gt; CONFIG . 'gpg' . DS . 'serverkey.asc',
                //'private' =&amp;gt; CONFIG . 'gpg' . DS . 'serverkey_private.asc',
            ],
        ],
    ],
]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;For now, do not forget to add &lt;code class=&quot;highlighter-rouge&quot;&gt;ssl.force =&amp;gt; false&lt;/code&gt; as seen above, or passbolt will redirect all your connections to a https socket, which will not work since it is not yet configured.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'ssl' =&amp;gt; [
    'force' =&amp;gt; false,
],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You can also set your configuration using environment variables.
Check &lt;code class=&quot;highlighter-rouge&quot;&gt;config/default.php&lt;/code&gt; to get the names of the environment variables.&lt;/p&gt;

    &lt;h3 id=&quot;run-the-install-script&quot;&gt;13. Run the install script&lt;/h3&gt;
    &lt;p&gt;Let’s install passbolt tables and data in the database.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake passbolt &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;The install script will ask you to create an admin user. Enter your first name, last name and email. In return, the script will
provide you with an activation link that you will user later to activate and configure your user. You can go to this url now or later, but we
recommend that you configure SSL before.&lt;/p&gt;

    &lt;p&gt;Optionally you can also run the health check to see if everything is fine.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake passbolt healthcheck
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You should see a majority of green ok. However, some SSL related alerts should still appear.&lt;/p&gt;

    &lt;h3 id=&quot;set-selinux-permissions&quot;&gt;14. Set Selinux permissions&lt;/h3&gt;
    &lt;p&gt;If your CentOS installation comes with SElinux enabled please follow this steps to make sure that passbolt works with it. If SElinux is disabled, there is no need to enable it in order for passbolt to work.&lt;/p&gt;

    &lt;p&gt;Check that selinux is enabled using (as root):&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sestatus
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Max kernel policy version:      28
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;First we grant access to the httpd service (nginx) access to the files under &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www&lt;/code&gt; recursively so it will also have access to &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/passbolt&lt;/code&gt; files.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;semanage fcontext &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; httpd_sys_content_t &lt;span class=&quot;s1&quot;&gt;'/var/www(/.*)?'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Passbolt will need to write on the tmp directory (for file caching for example) we grant read and write access to the httpd service to these directories:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;semanage fcontext &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; httpd_sys_rw_content_t &lt;span class=&quot;s1&quot;&gt;'/var/www/passbolt/tmp(/.*)?'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;Passbolt will also need to write on the logs directory. We grant read and write access to the httpd service to these directories:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;semanage fcontext &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; httpd_sys_rw_content_t &lt;span class=&quot;s1&quot;&gt;'/var/www/passbolt/logs(/.*)?'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Once the permissions are in place we tell SELinux to upgrade the file tags that we have just changed:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;restorecon &lt;span class=&quot;nt&quot;&gt;-Rv&lt;/span&gt; /var/www
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Passbolt and therefore the httpd service require read and write access to nginx gnupg keyring:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;semanage fcontext &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; httpd_sys_rw_content_t &lt;span class=&quot;s1&quot;&gt;'/var/lib/nginx/.gnupg(/.*)?'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;restorecon &lt;span class=&quot;nt&quot;&gt;-Rv&lt;/span&gt; /var/lib/nginx/.gnupg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;For more information on SELinux: &lt;a href=&quot;https://wiki.centos.org/HowTos/SELinux&quot;&gt;https://wiki.centos.org/HowTos/SELinux&lt;/a&gt;&lt;/p&gt;

    &lt;h3 id=&quot;its-running&quot;&gt;15. It’s running&lt;/h3&gt;
    &lt;p&gt;At this stage, passbolt is running as it should, but https is still missing. It is strongly recommended
that you configure https before using passbolt. We will go through it in the next section, as well as the emails configuration.&lt;/p&gt;

    &lt;h2 id=&quot;going-further&quot;&gt;Going further&lt;/h2&gt;

    &lt;h3 id=&quot;setup-the-emails&quot;&gt;1. Setup the emails&lt;/h3&gt;
    &lt;p&gt;For passbolt to be able to send emails, you must first configure properly the “EmailTransport” and “Email” section in the 
&lt;code class=&quot;highlighter-rouge&quot;&gt;config/passbolt.php&lt;/code&gt; file to match your provider smtp details.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// Email configuration.
    'EmailTransport' =&amp;gt; [
        'default' =&amp;gt; [
            'host' =&amp;gt; 'localhost',
            'port' =&amp;gt; 25,
            'username' =&amp;gt; 'user',
            'password' =&amp;gt; 'password',
            // Is this a secure connection? true if yes, null if no.
            'tls' =&amp;gt; null,
            //'timeout' =&amp;gt; 30,
            //'client' =&amp;gt; null,
            //'url' =&amp;gt; null,
        ],
    ],
    'Email' =&amp;gt; [
        'default' =&amp;gt; [
            // Defines the default name and email of the sender of the emails.
            'from' =&amp;gt; ['passbolt@your_organization.com' =&amp;gt; 'Passbolt'],
            //'charset' =&amp;gt; 'utf-8',
            //'headerCharset' =&amp;gt; 'utf-8',
        ],
    ],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;To send a test email and debug your smtp settings, you can use the following command:&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake passbolt send_test_email
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;When an email is sent, it is first placed in a queue that needs to be processed by the following shell.&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./bin/cake EmailQueue.sender
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;In order to have your emails sent automatically, you can add a cron call to the script so the emails will be sent every minute. 
Add the following line to you crontab:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; su &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/var/www/passbolt/bin/cake EmailQueue.sender &amp;gt;&amp;gt; /var/log/passbolt.log&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/bash nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;configure-https&quot;&gt;2. Configure https&lt;/h3&gt;
    &lt;p&gt;It is recommended to use https with passbolt (and, well, pretty much &lt;a href=&quot;https://www.eff.org/encrypt-the-web&quot;&gt;everything&lt;/a&gt;). 
To setup SSL we need a certificate. Here for the sake of brevity we will create a self-signed certificate. 
Of course you are free to use a &lt;a href=&quot;https://letsencrypt.org/getting-started/&quot;&gt;proper free certificate&lt;/a&gt; and tidy up the server supported cypher suites.&lt;/p&gt;

    &lt;p&gt;In the following steps, we’ll generate a self signed certificate and configure nginx and passbolt to use https.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;a. Generate the self signed certificate&lt;/strong&gt;&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;openssl req &lt;span class=&quot;nt&quot;&gt;-new&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-newkey&lt;/span&gt; rsa:4096 &lt;span class=&quot;nt&quot;&gt;-days&lt;/span&gt; 365 &lt;span class=&quot;nt&quot;&gt;-nodes&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x509&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-subj&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/C=FR/ST=Denial/L=Springfield/O=Dis/CN=passbolt.dev&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-keyout&lt;/span&gt; /etc/ssl/certs/passbolt.key &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; /etc/ssl/certs/passbolt.crt

Generating a 4096 bit RSA private key
................++
...++
writing new private key to &lt;span class=&quot;s1&quot;&gt;'/etc/ssl/certs/passbolt.key'&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;b. Make sure the certificate is readable by nginx&lt;/strong&gt;&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;root:nginx /etc/ssl/certs/passbolt.crt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chown &lt;/span&gt;root:nginx /etc/ssl/certs/passbolt.key
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;640 /etc/ssl/certs/passbolt.crt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;640 /etc/ssl/certs/passbolt.key
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;c. Configure ssl in nginx&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;Let’s add the rewrite and SSL rules and certificates.&lt;/p&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi /etc/nginx/conf.d/default.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Add this to your file, or replace the whole current content.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;server {
  listen 443;
  server_name passbolt.dev;
  ssl on;
  ssl_certificate     /etc/ssl/certs/passbolt.crt;
  ssl_certificate_key /etc/ssl/certs/passbolt.key;
  ssl_protocols TLSv1.2;
  ssl_prefer_server_ciphers on;
  ssl_ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS;
  ssl_session_tickets off;
  root /var/www/passbolt;
  
  location / {
    try_files $uri $uri/ /index.php?$args;
    index index.php;
  }
  
  location ~ \.php$ {
    fastcgi_index           index.php;
    fastcgi_pass            127.0.0.1:9000;
    fastcgi_split_path_info ^(.+\.php)(.+)$;
    include                 fastcgi_params;
    fastcgi_param           SCRIPT_FILENAME $document_root$fastcgi_script_name;
    fastcgi_param           SERVER_NAME $http_host;
  }
       
  location ~* \.(jpe?g|woff|woff2|ttf|gif|png|bmp|ico|css|js|json|pdf|zip|htm|html|docx?|xlsx?|pptx?|txt|wav|swf|svg|avi|mp\d)$ {
    access_log off;
    log_not_found off;
    try_files $uri /webroot/$uri /index.php?$args;
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;d. Restart Nginx&lt;/strong&gt;&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;systemctl restart nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;e. Force SSL in passbolt configuration&lt;/strong&gt;
We’ll need to change the passbolt configuration to make him use https instead of http,
and force the redirection to https:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;vi /var/www/passbolt/config/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Set fullBaseUrl to https&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'App' =&amp;gt; [
    'fullBaseUrl' =&amp;gt; 'https://passbolt.dev',
],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Set ssl.force config parameter to true, instead of false. You can also remove the line as it will be set to true by default.&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;'ssl' =&amp;gt; [
    'force' =&amp;gt; true,
],
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;That’s it! Passbolt is now ready to be used with https.&lt;/p&gt;

    &lt;p&gt;If you have already done the setup of your user, you will notice that passbolt tells you that the plugin is not configured to work with this domain. This is normal since it was already configured to work with http, and not https.&lt;/p&gt;

    &lt;p&gt;That’s not an issue, you can fix this easily by clicking on “recover an existing account”&lt;/p&gt;

    &lt;h2 id=&quot;thats-it&quot;&gt;That’s it&lt;/h2&gt;
    &lt;p&gt;Do let us know if you run into problems following this tutorial on the &lt;a href=&quot;support forum&quot;&gt;https://community.passbolt.com/c/installation-issues&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Thank you for trying out Passbolt CE!&lt;/p&gt;

    &lt;h3 id=&quot;troubleshooting&quot;&gt;Troubleshooting&lt;/h3&gt;

    &lt;p&gt;Here are some frequently asked questions related to passbolt installation:&lt;/p&gt;
    &lt;ul&gt;
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
    
    
    
        
            
                
    &lt;li&gt;
        &lt;a href=&quot;/faq/hosting/why-unsafe&quot;&gt;Why do I see an unsafe mode banner in the footer?&lt;/a&gt;
    &lt;/li&gt;
                
            
        
    
    
    
        
            
                
    &lt;li&gt;
        &lt;a href=&quot;/faq/hosting/why-email-not-sent&quot;&gt;Why are my emails not being sent?&lt;/a&gt;
    &lt;/li&gt;
                
            
        
    
    
    
        
    
    
    
    
    
        
    
    
    
        
    
    
    
    
    
    
    
    
    
    
    
    
    
    
&lt;/ul&gt;

    &lt;p&gt;Feel free to ask for help on the &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot;&gt;community forum&lt;/a&gt;.&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
April
9th,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when installing passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;&lt;strong&gt;Don't want the hassle of a manual installation?&lt;/strong&gt; Passbolt Pro comes with out of the box install scripts and a ready-to-use VM.&lt;/p&gt;
    &lt;a href=&quot;https://www.passbolt.com/pricing/pro&quot; class=&quot;button primary&quot;&gt;Get Passbolt Pro&lt;/a&gt;

&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Upgrade from CE v2 to Pro using docker</title><link href="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v2-docker.html" rel="alternate" type="text/html" title="Upgrade from CE v2 to Pro using docker" /><published>2018-04-09T05:30:00+05:30</published><updated>2018-04-09T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v2-docker</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v2-docker.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This tutorial covers the case where you want to upgrade from your passbolt CE v2.x into Passbolt Pro when using docker.&lt;/p&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        &lt;strong&gt;Important:&lt;/strong&gt; Please take a full &lt;a href=&quot;/hosting/backup-v1&quot;&gt;backup&lt;/a&gt; of your passbolt before proceeding with the upgrade. Backup should include passbolt files as well as the database.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;p&gt;In order to upgrade from v2 CE to Pro users just need to download the pro container and mount their corresponding subscription key.&lt;/p&gt;

    &lt;h2 id=&quot;getting-passbolt-container&quot;&gt;Getting passbolt container&lt;/h2&gt;

    &lt;p&gt;Passbolt containers follow the following tagging:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;version_number&amp;gt;-&amp;lt;build_number&amp;gt;-pro-debian
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Nobody is perfect so we also provide a  &lt;em&gt;latest&lt;/em&gt; tag for Passbolt containers. Through all this documentation pages we make use of the latest tag so users will get the last version of passbolt.
However, it is recommended that users pull the tags pointing to specific passbolt versions when running in environments other than testing.&lt;/p&gt;

    &lt;p&gt;Get passbolt Pro latest docker container:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker pull passbolt/passbolt:latest-pro
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;using-host-bind-mounts&quot;&gt;Using host bind mounts&lt;/h3&gt;

    &lt;p&gt;Users that use host bind mounts from host machine into docker file must adjust paths of the mounted files:&lt;/p&gt;

    &lt;p&gt;In the following snippet:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;passbolt_images_dir: path to a host directory that contains passbolt images Avatar directory.&lt;/li&gt;
      &lt;li&gt;gpg_host_dir: path to a host directory that contains serverkey.asc and serverkey_private.asc&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; passbolt-pro &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;passbolt_images_dir&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/webroot/img &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;path_subscription&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/license &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;gpg_host_dir&amp;gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/gpg &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;APP_FULL_BASE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://mydomain.com &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             passbolt/passbolt:latest-pro
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;using-docker-volumes&quot;&gt;Using docker volumes&lt;/h3&gt;

    &lt;p&gt;Users that use docker volumes should adjust their volumes paths.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; passbolt-pro &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;passbolt_images_volume&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/webroot/img &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;path_subscription&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/license &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;gpg_keys_volume&amp;gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/gpg &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;APP_FULL_BASE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://mydomain.com &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             passbolt/passbolt:latest-pro
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Upgrade from CE v1 to Pro using docker</title><link href="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-docker.html" rel="alternate" type="text/html" title="Upgrade from CE v1 to Pro using docker" /><published>2018-04-09T05:30:00+05:30</published><updated>2018-04-09T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-docker</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-docker.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This tutorial covers the case where you want to upgrade from your passbolt CE v1.x into Passbolt Pro when using docker.&lt;/p&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        &lt;strong&gt;Important:&lt;/strong&gt; Please take a full &lt;a href=&quot;/hosting/backup-v1&quot;&gt;backup&lt;/a&gt; of your passbolt before proceeding with the upgrade. Backup should include passbolt files as well as the database.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;p&gt;The upgrading process is very similar to the one listed in the &lt;a href=&quot;/hosting/upgrade/ce/upgrade-docker-ce.html&quot;&gt;ce section&lt;/a&gt;. The main difference is that Passbolt Pro requires a subscription key to
work.&lt;/p&gt;

    &lt;h2 id=&quot;upgrade-from-v1610-debian&quot;&gt;Upgrade from v1.6.10-debian&lt;/h2&gt;

    &lt;p&gt;Passbolt v2 introduces several changes that are important to keep in mind when upgrading:&lt;/p&gt;

    &lt;h4 id=&quot;changes-environment-variables&quot;&gt;Changes: Environment variables&lt;/h4&gt;

    &lt;p&gt;The set of environment variables have changed and users should take some time to get familiar with the new ones. For example in case of the database env variables:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DB_USER is now DATASOURCES_DEFAULT_USERNAME
DB_HOST is now DATASOURCES_DEFAULT_HOST
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;There is a more detailed list in passbolt_docker &lt;a href=&quot;https://github.com/passbolt/passbolt_docker/blob/master/README.md&quot;&gt;README&lt;/a&gt; file.&lt;/p&gt;

    &lt;h4 id=&quot;changes-configuration-files&quot;&gt;Changes: Configuration files&lt;/h4&gt;

    &lt;p&gt;No more core.php, email.php or database.php.
Any user that does not want to use environment variables must configure passbolt using:&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt/config/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;Passbolt will look for for configuration values in &lt;code class=&quot;highlighter-rouge&quot;&gt;passbolt.php&lt;/code&gt;. Wether &lt;code class=&quot;highlighter-rouge&quot;&gt;passbolt.php&lt;/code&gt; does not exist or the configuration section is not defined on it, passbolt will then look for configuration details in default.php which relies on environment variables/default values.
Gpg config directory has changed slightly its path from:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt/app/Config/gpg/ to /var/www/passbolt/config/gpg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Gpg default server key file names also changed:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;serverkey.private.asc to serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;changes-www-user&quot;&gt;Changes: www user&lt;/h4&gt;

    &lt;p&gt;Passbolt container is now running under the www-data user&lt;/p&gt;

    &lt;h4 id=&quot;changes-images-directory&quot;&gt;Changes: images directory&lt;/h4&gt;

    &lt;p&gt;Path to the images directory is different:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt/app/webroot/img/public/images to /var/www/passbolt/webroot/img/public/images
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Users must also rename ProfileAvatar to Avatar directory inside public/images in order to see images in passbolt v2&lt;/p&gt;

    &lt;h4 id=&quot;changes-supervisor&quot;&gt;Changes: supervisor&lt;/h4&gt;

    &lt;p&gt;In order to manage the running process in passbolt container we introduced supervisord. Users are now able to restart passbolt container processes using:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;passbolt supervisorctl restart &amp;lt;php-fpm|nginx|cron&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Now that we have a better overview of the changes let’s start with the upgrading process!&lt;/p&gt;

    &lt;h3 id=&quot;backup-mysql-database&quot;&gt;Backup mysql database&lt;/h3&gt;

    &lt;p&gt;First of all is encouraged to backup all the relevant data that is:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Database&lt;/li&gt;
      &lt;li&gt;Images&lt;/li&gt;
      &lt;li&gt;Server public and private keys&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;You might want to check the detailed &lt;a href=&quot;/hosting/backup-v1&quot;&gt;backup list for v1&lt;/a&gt;&lt;/p&gt;

    &lt;p&gt;There are multiple ways to backup your database following there is an example using the passbolt container:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;passbolt mysqldump &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; &amp;lt;db_host&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                                 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; passbolt &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                                 &lt;span class=&quot;nt&quot;&gt;-pP4ssb0lt&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
                                 passbolt &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dump.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;This will output a dump.sql file on the host machine.&lt;/p&gt;

    &lt;h3 id=&quot;backup-images-directory&quot;&gt;Backup images directory&lt;/h3&gt;

    &lt;p&gt;If you are mounting the images directory using a bind mount just copy the host image directory in a safe location.
If you are using docker volumes to persist your images directory, or not persisting the images directory at all, you can execute the following to copy your images to the host machine.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;passbolt:/var/www/app/webroot/img/public public_images_backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;This will output a public_images_directory with the images stored in the passbolt container.&lt;/p&gt;

    &lt;h3 id=&quot;backup-gpg-keys&quot;&gt;Backup gpg keys&lt;/h3&gt;

    &lt;p&gt;As with the previous section you can proceed exactly the same with the gpg keys:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;passbolt:/var/www/app/Config/gpg/ gpg_keys_backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;This will output a gpg_keys_backup directory with the contents of the gpg configuration folder of passbolt.&lt;/p&gt;

    &lt;h2 id=&quot;getting-passbolt-container&quot;&gt;Getting passbolt container&lt;/h2&gt;

    &lt;p&gt;Passbolt containers follow the following tagging:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;version_number&amp;gt;-&amp;lt;build_number&amp;gt;-pro-debian
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Nobody is perfect so we also provide a  &lt;em&gt;latest&lt;/em&gt; tag for Passbolt containers. Through all this documentation pages we make use of the latest tag so users will get the last version of passbolt.
However, it is recommended that users pull the tags pointing to specific passbolt versions when running in environments other than testing.&lt;/p&gt;

    &lt;p&gt;Get passbolt Pro latest docker container:&lt;/p&gt;
    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker pull passbolt/passbolt:latest-pro
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;upgrade-using-latest-v1-version-1610&quot;&gt;Upgrade using latest v1 version (1.6.10)&lt;/h2&gt;

    &lt;p&gt;Passbolt Pro v2 will run the database migrations if needed when starting up. Users just need to provide the gpg keys, configuration files/env variables and images.
Following some examples:&lt;/p&gt;

    &lt;h3 id=&quot;using-host-bind-mounts&quot;&gt;Using host bind mounts&lt;/h3&gt;

    &lt;p&gt;Users that use host bind mounts from host machine into docker file must adjust paths of the mounted files:&lt;/p&gt;

    &lt;p&gt;In the following snippet:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;passbolt_images_dir: path to a host directory that contains passbolt images Avatar directory.&lt;/li&gt;
      &lt;li&gt;gpg_host_dir: path to a host directory that contains serverkey.asc and serverkey_private.asc&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; passbolt-pro &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;passbolt_images_dir&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/webroot/img &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;path_subscription&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/license &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;gpg_host_dir&amp;gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/gpg &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;APP_FULL_BASE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://mydomain.com &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             passbolt/passbolt:latest-pro
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;using-docker-volumes&quot;&gt;Using docker volumes&lt;/h3&gt;

    &lt;p&gt;Users that use docker volumes should adjust their volumes paths.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; passbolt-pro &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;passbolt_images_volume&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/webroot/img &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bind&lt;/span&gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;path_subscription&amp;gt;,&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/license &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;gpg_keys_volume&amp;gt;, &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
               &lt;span class=&quot;nv&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/passbolt/config/gpg &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;DATASOURCES_DEFAULT_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mysql_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;APP_FULL_BASE_URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;https://mydomain.com &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             passbolt/passbolt:latest-pro
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Upgrade Passbolt from v1 to Pro on the same server</title><link href="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-same-server.html" rel="alternate" type="text/html" title="Upgrade Passbolt from v1 to Pro on the same server" /><published>2018-04-09T05:30:00+05:30</published><updated>2018-04-09T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-same-server</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-same-server.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This tutorial covers the case where you want to upgrade your current instance of passbolt CE v1.x into Passbolt Pro on the same server.&lt;/p&gt;

    &lt;p&gt;If you want to use a new server, &lt;a href=&quot;/hosting/upgrade/pro/upgrade-ce-v1-to-pro-new-server&quot;&gt;follow this link&lt;/a&gt;.&lt;/p&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        &lt;strong&gt;Important:&lt;/strong&gt; Please take a full &lt;a href=&quot;/hosting/backup-v1&quot;&gt;backup&lt;/a&gt; of your Passbolt CE before proceeding with the upgrade. Backup should include passbolt files as well as the database.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;h2 id=&quot;system-requirements&quot;&gt;System requirements&lt;/h2&gt;
    &lt;p&gt;Passbolt is reported to work on a large variety of operating system configurations. 
Therefore this help page is a generic guide that should work for most environments.&lt;/p&gt;

    &lt;p&gt;If you run into any issues with your particular configuration, 
&lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot;&gt;please check the forum&lt;/a&gt;. 
Maybe someone else has had your issue. If not, make a post and the community will try to help you.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Any Unix-like major distribution (Debian, Centos, Ubuntu, *BSD)&lt;/li&gt;
      &lt;li&gt;A webserver (Apache or Nginx)&lt;/li&gt;
      &lt;li&gt;A TLS server certificate for HTTPS&lt;/li&gt;
      &lt;li&gt;PHP &amp;gt;= 7.0.0&lt;/li&gt;
      &lt;li&gt;Mysql &amp;gt;= 5.5.59&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://getcomposer.org/download/&quot;&gt;Composer&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://gnupg.org/&quot;&gt;GnuPG&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://git-scm.com/&quot;&gt;Git&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;The following PHP extensions (that may or may not come by default):&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;http://php.net/manual/en/gnupg.installation.php&quot;&gt;PHP-GNUPG&lt;/a&gt;: for key verification and authentication.&lt;/li&gt;
      &lt;li&gt;Cakephp default requirements: Intl, mbstring, simplexml&lt;/li&gt;
      &lt;li&gt;Image manipulation: gd or imagick&lt;/li&gt;
      &lt;li&gt;Database: Mysqlnd, pdo, pdo_mysql&lt;/li&gt;
      &lt;li&gt;Some general default: xsl, phar, posix, xml, zlib, ctype, curl, json.&lt;/li&gt;
      &lt;li&gt;&amp;amp; more depending on your configuration (for example if you want to use memcache for sessions).&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;upgrade-to-passbolt-pro&quot;&gt;Upgrade to Passbolt Pro&lt;/h2&gt;
    &lt;p&gt;In the following examples we assume you are running passbolt CE v1 using apache in the &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/passbolt&lt;/code&gt;
directory. You will need to replace these values with your local environment settings.&lt;/p&gt;

    &lt;h3 id=&quot;make-sure-you-have-the-latest-v1x-version&quot;&gt;1. Make sure you have the latest v1.x version&lt;/h3&gt;
    &lt;p&gt;If you do not have the latest version, please follow the regular &lt;a href=&quot;/hosting/update-v1&quot;&gt;v1 udpate process&lt;/a&gt;.
We’ll also assume you have a web server that match the system requirements.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;app/Config/version.php  | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;number
&lt;span class=&quot;s1&quot;&gt;'number'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'1.6.10'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;take-your-site-offline&quot;&gt;2. Take your site offline&lt;/h3&gt;
    &lt;p&gt;There are multiple ways of doing that, the simplest is sending a notice by email to your users
and stopping your webserver. The better approach would be to create a temporary html file and
redirect your passbolt user there, for example:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;wip
/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;touch &lt;/span&gt;wip/index.html
/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;Maintenance in progress&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;&amp;lt;h1&amp;gt;Maintenance in progress&amp;lt;/h1&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; wip/index.html
/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano /etc/apache2/sites-enabled/001-default.conf

&amp;lt;IfModule mod_ssl.c&amp;gt;
        &amp;lt;VirtualHost _default_:443&amp;gt;
                ServerAdmin webmaster@localhost
                ServerName www.passbolt.test
                DocumentRoot /var/www/wip

                ErrorLog &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;APACHE_LOG_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/error.log
                CustomLog &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;APACHE_LOG_DIR&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;/access.log combined

                SSLEngine on
                SSLCertificateFile /etc/apache2/ssl/passbolt.crt
                SSLCertificateKeyFile /etc/apache2/ssl/passbolt.key

        &amp;lt;Directory /var/www/wip&amp;gt;
            Options FollowSymLinks
            AllowOverride All
            Require all granted
        &amp;lt;/Directory&amp;gt;

        &amp;lt;/VirtualHost&amp;gt;
&amp;lt;/IfModule&amp;gt;
/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;service apache2 restart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;download-passbolt-pro&quot;&gt;3. Download Passbolt Pro&lt;/h3&gt;
    &lt;p&gt;Open a shell with the same user as your web server user. (usually, www-data for apache, nginx for nginx)&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /bin/bash www-data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Replace the previous passbolt by the new version.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; ./passbolt ./passbolt_old
/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://bitbucket.org/passbolt_pro/passbolt_pro_api.git ./passbolt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;install-the-dependencies&quot;&gt;4. Install the dependencies&lt;/h3&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ./passbolt
/var/www/passbolt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;composer &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;copy-the-avatar-folder&quot;&gt;5. Copy the avatar folder&lt;/h3&gt;
    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/var/www/passbolt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; ../passbolt_old/app/webroot/img/public/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; ./webroot/img/public/.
/var/www/passbolt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; ./webroot/img/public/images/ProfileAvatar ./webroot/img/public/images/Avatar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;configure-passbolt-pro&quot;&gt;6. Configure Passbolt Pro&lt;/h3&gt;
    &lt;p&gt;To configure Passbolt Pro, the easiest way is to use the in-built configuration wizard.
Just point your browser to your passbolt url.&lt;/p&gt;

    &lt;p&gt;You will be greeted by a welcome screen. Click on the Configure with wizard option and follow the instructions.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/04/passbolt-welcome-page.png&quot; alt=&quot;passbolt welcome page before configuration&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. passbolt welcome page before configuration&lt;/span&gt;
&lt;/figure&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        &lt;strong&gt;Note:&lt;/strong&gt; Enter the same configuration details as the the ones that were used for your Passbolt CE.
    This includes your database, smtp details, as well as your server GPG key that you’ll need to import (&lt;strong&gt;Do not generate a new one&lt;/strong&gt;).
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/04/wizard-key-import.png&quot; alt=&quot;Wizard - import key screen&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Wizard - import key screen&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;your-server-is-now-ready-to-run-passbolt&quot;&gt;7. Your server is now ready to run passbolt&lt;/h3&gt;

    &lt;p&gt;Once you have followed all the steps of the wizard, Passbolt Pro is ready to run. You will be redirected
automatically to the login page where you can log in.&lt;/p&gt;

    &lt;h3 id=&quot;final-step-modify-the-cron-job-to-send-emails&quot;&gt;8. Final step: modify the cron job to send emails&lt;/h3&gt;

    &lt;p&gt;Modify the cronjob entry you had added for passbolt CE v1 :&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;* * * * * /var/www/passbolt/app/Console/cake EmailQueue.sender &amp;gt; /var/log/passbolt.log
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;into this one:&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;* * * * * /var/www/passbolt/bin/cake EmailQueue.sender &amp;gt; /var/log/passbolt.log
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;thats-it&quot;&gt;That’s it!&lt;/h2&gt;

    &lt;p&gt;At this stage, Passbolt Pro should be working perfectly.&lt;/p&gt;

    &lt;p&gt;Any issue? Do contact us on the &lt;a href=&quot;mailto:contact@passbolt.com&quot;&gt;Passbolt Pro support&lt;/a&gt; with the email provided during your purchase.&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
April
9th,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues with Passbolt Pro?&lt;/p&gt;
    &lt;a href=&quot;mailto:contact@passbolt.com&quot; class=&quot;button primary&quot;&gt;Contact Pro support&lt;/a&gt;
    &lt;p&gt;or &lt;a href=&quot;https://community.passbolt.com&quot;&gt;ask the community&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Upgrade Passbolt from v1 to Pro on a new server</title><link href="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-new-server.html" rel="alternate" type="text/html" title="Upgrade Passbolt from v1 to Pro on a new server" /><published>2018-04-09T05:30:00+05:30</published><updated>2018-04-09T05:30:00+05:30</updated><id>https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-new-server</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/upgrade-pro-from-ce-v1-new-server.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This tutorial will be available soon.&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
April
9th,
2018.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues with Passbolt Pro?&lt;/p&gt;
    &lt;a href=&quot;mailto:contact@passbolt.com&quot; class=&quot;button primary&quot;&gt;Contact Pro support&lt;/a&gt;
    &lt;p&gt;or &lt;a href=&quot;https://community.passbolt.com&quot;&gt;ask the community&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry></feed>