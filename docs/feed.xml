<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.1">Jekyll</generator><link href="https://help.passbolt.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://help.passbolt.com/" rel="alternate" type="text/html" /><updated>2021-10-05T10:04:21+02:00</updated><id>https://help.passbolt.com/feed.xml</id><title type="html">Passbolt | Help</title><subtitle>The help site for passbolt, the open source password manager for teams. This site contains frequently asked questions, article to troubleshoot common issues, installation tutorials, blueprints for developers, and more!</subtitle><entry><title type="html">Docker</title><link href="https://help.passbolt.com/hosting/backup/docker.html" rel="alternate" type="text/html" title="Docker" /><published>2021-10-01T02:00:00+02:00</published><updated>2021-10-01T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/backup/docker</id><content type="html" xml:base="https://help.passbolt.com/hosting/backup/docker.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;Making regular backups is a critical aspect of managing a passbolt instance. Because passbolt stores important
information, it is equally important to have a backup strategy in place.&lt;/p&gt;

    &lt;p&gt;As a passbolt administrator it is your responsibility to define how often and when to perform backups.
Please automate and customize this process to match the needs and policies of your organization.&lt;/p&gt;

    &lt;p&gt;Here are some best practices to keep in mind:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Ensure that the backups are taken at intervals that match your usage&lt;/li&gt;
      &lt;li&gt;Take these backups off-site, or to another environment than the live one&lt;/li&gt;
      &lt;li&gt;Make sure the backup is encrypted and stored in a safe location&lt;/li&gt;
      &lt;li&gt;Practice drills and test the backups to make sure they work&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;what-to-backup&quot;&gt;What to backup?&lt;/h2&gt;

    &lt;p&gt;If you are a PRO user, ensure you have a backup of your subscription key.&lt;/p&gt;

    &lt;p&gt;There are also several elements you need to backup:&lt;/p&gt;

    &lt;p&gt;We assume here Passbolt container is named “&lt;strong&gt;passbolt-container&lt;/strong&gt;” and MariaDB 
container “&lt;strong&gt;database-container&lt;/strong&gt;”.
Please replace these names with your own. You can use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker ps&lt;/code&gt; for this.&lt;/p&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        Many docker users use “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-ti&lt;/code&gt;”, “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-it&lt;/code&gt;” or “&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-t -i&lt;/code&gt;” arguments to execute commands on docker containers. To get reliable backups on docker, please use only &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-i&lt;/code&gt;, as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-t&lt;/code&gt; will create a pseudo-tty and make your backup files unusuable.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;h4 id=&quot;the-database&quot;&gt;1. The database&lt;/h4&gt;

    &lt;p&gt;This can be easily scripted using &lt;a href=&quot;https://mariadb.com/kb/en/mariadb/mysqldump/&quot;&gt;mysqldump&lt;/a&gt;.
Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker exec&lt;/code&gt; to connect to the Passbolt database container and write mysqldump output to a local file.&lt;/p&gt;

    &lt;p&gt;Be sure to use simple-quotes for the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bash -c&lt;/code&gt; argument to be able to use MYSQL_USER, MYSQL_PASSWORD and MYSQL_DATABASE environment variables.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; database-container bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;'mysqldump -u${MYSQL_USER} -p${MYSQL_PASSWORD} ${MYSQL_DATABASE}'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /path/to/backup.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;the-server-public-and-private-keys&quot;&gt;2. The server public and private keys&lt;/h4&gt;

    &lt;p&gt;You can use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker cp&lt;/code&gt; to backup the Passbolt GPG keys:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;passbolt-container:/etc/passbolt/gpg/serverkey_private.asc &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    /path/to/backup/serverkey_private.asc
docker &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;passbolt-container:/etc/passbolt/gpg/serverkey.asc &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    /path/to/backup/serverkey.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;the-application-configuration&quot;&gt;3. The application configuration&lt;/h4&gt;

    &lt;p&gt;Passbolt docker stores its configuration as environment variables.&lt;/p&gt;

    &lt;p&gt;If you are using docker-compose, environment variables are on the env folder:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;env/passbolt.env&lt;/li&gt;
      &lt;li&gt;env/mysql.env&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;If you are running docker container, you should have passed these variables through the command line.
Please check the
&lt;a href=&quot;/configure/environment/reference.html&quot;&gt;passbolt env variable reference&lt;/a&gt;&lt;/p&gt;

    &lt;h4 id=&quot;the-avatars-for-passbolt-version-prior-to-32&quot;&gt;4. The avatars (for Passbolt version prior to 3.2)&lt;/h4&gt;

    &lt;div class=&quot;message notice&quot;&gt;
    &lt;p&gt;
    Since Passbolt 3.2, user’s avatars are no longer stored on disk but on the avatars table of passbolt database.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; passbolt-container &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;cvfzp - &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; /usr/share/php/passbolt/ webroot/img/avatar &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; passbolt-avatars.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;backup-list&quot;&gt;Backup list&lt;/h2&gt;

    &lt;p&gt;At the end of the backup process you should have:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;a dump of your database&lt;/li&gt;
      &lt;li&gt;the server public and private GPG keys&lt;/li&gt;
      &lt;li&gt;a copy of your config/passbolt.php configuration file&lt;/li&gt;
      &lt;li&gt;a copy of your avatar folder (&lt;strong&gt;only if Passbolt version &amp;lt; 3.2&lt;/strong&gt;)&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;what-about-the-secret-keys-of-my-collaborators&quot;&gt;What about the secret keys of my collaborators?&lt;/h2&gt;

    &lt;p&gt;Every user private key should also be backed up, this is however not something we/you can automate easily for now (passbolt might provide a functionality for this in the future). We believe it is best if this is the responsibility of the end user. There is a dedicated step during the extension setup to that purpose.&lt;/p&gt;

    &lt;p&gt;As an administrator you should stress the importance of backing up secret keys to other users. For example this warning could be part of the initial information message sent to introduce passbolt to new users.&lt;/p&gt;

    &lt;p&gt;It is possible that having users back up their own keys may not be realistic or desirable in your case. In this case you can opt in for an alternative strategy such as setting up the account with/for them and taking a backup of the secret keys then. In the worst case scenario you could automate the process by installing a script on your users machine that would make that backup for you.&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
October
1st,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Do you have a question about backups? Do you want to share your experience and best practices?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Get in touch!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="backup" /><summary type="html"></summary></entry><entry><title type="html">Migrate an existing Passbolt CE to a new Docker</title><link href="https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-docker.html" rel="alternate" type="text/html" title="Migrate an existing Passbolt CE to a new Docker" /><published>2021-09-29T02:00:00+02:00</published><updated>2021-09-29T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-docker</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-docker.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This document describes how to migrate an existing passbolt to a new  server.&lt;/p&gt;

    &lt;h2 id=&quot;pre-requisites&quot;&gt;Pre-requisites&lt;/h2&gt;

    &lt;p&gt;For this tutorial, you will need:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Passbolt installed on an old server&lt;/li&gt;
      &lt;li&gt;A new server with Docker&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;backup-the-existing-data&quot;&gt;Backup the existing data&lt;/h2&gt;

    &lt;p&gt;Prior to the migration you will need to backup the existing passbolt instance data. Please refer to &lt;a href=&quot;/hosting/backup&quot;&gt;the official backup documentations&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Depending on your SSL configuration you might need to copy the certificate and key from the existing instance.&lt;/p&gt;

    &lt;p&gt;Don’t delete the existing instance yet!&lt;/p&gt;

    &lt;h2 id=&quot;prepare-the-new-server&quot;&gt;Prepare the new server&lt;/h2&gt;

    &lt;p&gt;Create a fresh new Passbolt instance on Docker following &lt;a href=&quot;/hosting/install/ce/docker.html&quot;&gt;this documentation&lt;/a&gt;.&lt;/p&gt;

    &lt;h2 id=&quot;migrate-the-data&quot;&gt;Migrate the data&lt;/h2&gt;

    &lt;h3 id=&quot;stop-running-containers&quot;&gt;Stop running containers&lt;/h3&gt;

    &lt;p&gt;At this step, you should have a running empty Passbolt instance running on your server. We will now stop it and delete the database volume.&lt;/p&gt;

    &lt;p&gt;If you have chosen the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker-compose&lt;/code&gt; install, you just have to delete the volumes you created with this command (don’t forget the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-v&lt;/code&gt;):&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker-compose down &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;If you have chosen to run docker containers, stop them and delete the database volume:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker stop passbolt-container-name
docker stop passbolt-database-name
docker volume rm passbolt-database-volume-name
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Of course, replace containers and volume name with your own !&lt;/p&gt;

    &lt;h3 id=&quot;restore-your-database&quot;&gt;Restore your database&lt;/h3&gt;

    &lt;p&gt;According to &lt;a href=&quot;https://hub.docker.com/_/mariadb&quot;&gt;MariaDB documentation on Docker Hub&lt;/a&gt;:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;When a container is started for the first time, a new database with the specified name will be created and initialized with the provided configuration variables.

Furthermore, it will execute files with extensions .sh, .sql, .sql.gz, and .sql.xz that are found in /docker-entrypoint-initdb.d. Files will be executed in alphabetical order. .sh files without file execute permission are sourced rather than executed.

You can easily populate your mariadb services by mounting a SQL dump into that directory and provide custom images with contributed data. SQL files will be imported by default to the database specified by the MARIADB_DATABASE / MYSQL_DATABASE variable.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;So you just have to mount your database backup file on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/docker-entrypoint-initdb.d&lt;/code&gt; folder of the database container.&lt;/p&gt;

    &lt;p&gt;If you are using docker-compose, add a volume mount in the db service:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;volumes:
  - database_volume:/var/lib/mysql
  - ./path/to/your/database/dump.sql:/docker-entrypoint-initdb.d/dump.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;And if you are not using compose, add a volume to your docker command, eg:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; mariadb &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mariadb_passbolt_data,target&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;./path/to/your/database/dump.sql:/docker-entrypoint-initdb.d/dump.sql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;root_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mariadb_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mariadb_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mariadb_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You can now start your database and passbolt containers, your database will be restored at the database container start.&lt;/p&gt;

    &lt;h3 id=&quot;restore-gpg-server-keys&quot;&gt;Restore GPG server keys&lt;/h3&gt;

    &lt;p&gt;Copy the GPG you backed up in your container:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker cp serverkey_private.asc your-passbolt-container:/etc/passbolt/gpg/serverkey_private.asc
docker cp serverkey.asc your-passbolt-container:/etc/passbolt/gpg/serverkey.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Then set correct rights:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker exec -it your-passbolt-container chown www-data:www-data /etc/passbolt/gpg/serverkey.asc
docker exec -it your-passbolt-container chown www-data:www-data /etc/passbolt/gpg/serverkey_private.asc
docker exec -it your-passbolt-container chmod 440 /etc/passbolt/gpg/serverkey.asc
docker exec -it your-passbolt-container chmod 440 /etc/passbolt/gpg/serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;restore-avatars-if-you-are-coming-for-prior-32&quot;&gt;Restore avatars (if you are coming for prior 3.2)&lt;/h3&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        This step is needed only if you come from Passbolt version prior to 3.2. Since 3.2, avatars are stored in database
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;p&gt;Extract the avatars to the Passbolt docker container:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cat passbolt-avatars.tar.gz | docker exec -i your-passbolt-container tar -C /usr/share/php/passbolt/ -xzf -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Then set correct rights to the avatars:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker exec -it your-passbolt-container chown -R www-data:www-data /usr/share/php/passbolt/webroot/img/avatar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
29th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="upgrade" /><category term="ce" /><summary type="html"></summary></entry><entry><title type="html">Migrate an existing Passbolt PRO to a new Docker</title><link href="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-docker.html" rel="alternate" type="text/html" title="Migrate an existing Passbolt PRO to a new Docker" /><published>2021-09-29T02:00:00+02:00</published><updated>2021-09-29T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-docker</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-docker.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This document describes how to migrate an existing passbolt to a new  server.&lt;/p&gt;

    &lt;h2 id=&quot;pre-requisites&quot;&gt;Pre-requisites&lt;/h2&gt;

    &lt;p&gt;For this tutorial, you will need:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Passbolt installed on an old server&lt;/li&gt;
      &lt;li&gt;A new server with Docker&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;backup-the-existing-data&quot;&gt;Backup the existing data&lt;/h2&gt;

    &lt;p&gt;Prior to the migration you will need to backup the existing passbolt instance data. Please refer to &lt;a href=&quot;/hosting/backup&quot;&gt;the official backup documentations&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Depending on your SSL configuration you might need to copy the certificate and key from the existing instance.&lt;/p&gt;

    &lt;p&gt;Don’t delete the existing instance yet!&lt;/p&gt;

    &lt;h2 id=&quot;prepare-the-new-server&quot;&gt;Prepare the new server&lt;/h2&gt;

    &lt;p&gt;Create a fresh new Passbolt instance on Docker following &lt;a href=&quot;/hosting/install/pro/docker.html&quot;&gt;this documentation&lt;/a&gt;.&lt;/p&gt;

    &lt;h2 id=&quot;migrate-the-data&quot;&gt;Migrate the data&lt;/h2&gt;

    &lt;h3 id=&quot;stop-running-containers&quot;&gt;Stop running containers&lt;/h3&gt;

    &lt;p&gt;At this step, you should have a running empty Passbolt instance running on your server. We will now stop it and delete the database volume.&lt;/p&gt;

    &lt;p&gt;If you have chosen the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;docker-compose&lt;/code&gt; install, you just have to delete the volumes you created with this command (don’t forget the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-v&lt;/code&gt;):&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker-compose down &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;If you have chosen to run docker containers, stop them and delete the database volume:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker stop passbolt-container-name
docker stop passbolt-database-name
docker volume rm passbolt-database-volume-name
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Of course, replace containers and volume name with your own !&lt;/p&gt;

    &lt;h3 id=&quot;restore-your-database&quot;&gt;Restore your database&lt;/h3&gt;

    &lt;p&gt;According to &lt;a href=&quot;https://hub.docker.com/_/mariadb&quot;&gt;MariaDB documentation on Docker Hub&lt;/a&gt;:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;When a container is started for the first time, a new database with the specified name will be created and initialized with the provided configuration variables.

Furthermore, it will execute files with extensions .sh, .sql, .sql.gz, and .sql.xz that are found in /docker-entrypoint-initdb.d. Files will be executed in alphabetical order. .sh files without file execute permission are sourced rather than executed.

You can easily populate your mariadb services by mounting a SQL dump into that directory and provide custom images with contributed data. SQL files will be imported by default to the database specified by the MARIADB_DATABASE / MYSQL_DATABASE variable.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;So you just have to mount your database backup file on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/docker-entrypoint-initdb.d&lt;/code&gt; folder of the database container.&lt;/p&gt;

    &lt;p&gt;If you are using docker-compose, add a volume mount in the db service:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;volumes:
  - database_volume:/var/lib/mysql
  - ./path/to/your/database/dump.sql:/docker-entrypoint-initdb.d/dump.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;And if you are not using compose, add a volume to your docker command, eg:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; mariadb &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; passbolt_network &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mariadb_passbolt_data,target&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/mysql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;--mount&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;./path/to/your/database/dump.sql:/docker-entrypoint-initdb.d/dump.sql &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;root_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_DATABASE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mariadb_database&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mariadb_user&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;lt;mariadb_password&amp;gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
             mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You can now start your database and passbolt containers, your database will be restored at the database container start.&lt;/p&gt;

    &lt;h3 id=&quot;restore-gpg-server-keys&quot;&gt;Restore GPG server keys&lt;/h3&gt;

    &lt;p&gt;Copy the GPG you backed up in your container:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker cp serverkey_private.asc your-passbolt-container:/etc/passbolt/gpg/serverkey_private.asc
docker cp serverkey.asc your-passbolt-container:/etc/passbolt/gpg/serverkey.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Then set correct rights:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker exec -it your-passbolt-container chown www-data:www-data /etc/passbolt/gpg/serverkey.asc
docker exec -it your-passbolt-container chown www-data:www-data /etc/passbolt/gpg/serverkey_private.asc
docker exec -it your-passbolt-container chmod 440 /etc/passbolt/gpg/serverkey.asc
docker exec -it your-passbolt-container chmod 440 /etc/passbolt/gpg/serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;restore-avatars-if-you-are-coming-for-prior-32&quot;&gt;Restore avatars (if you are coming for prior 3.2)&lt;/h3&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        This step is needed only if you come from Passbolt version prior to 3.2. Since 3.2, avatars are stored in database
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;p&gt;Extract the avatars to the Passbolt docker container:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cat passbolt-avatars.tar.gz | docker exec -i your-passbolt-container tar -C /usr/share/php/passbolt/ -xzf -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Then set correct rights to the avatars:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker exec -it your-passbolt-container chown -R www-data:www-data /usr/share/php/passbolt/webroot/img/avatar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
29th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="upgrade" /><category term="pro" /><summary type="html"></summary></entry><entry><title type="html">Migrate an existing Passbolt PRO to Virtual Machine</title><link href="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-virtual-machine.html" rel="alternate" type="text/html" title="Migrate an existing Passbolt PRO to Virtual Machine" /><published>2021-09-16T02:00:00+02:00</published><updated>2021-09-16T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-virtual-machine</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-virtual-machine.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This document describes how to migrate an existing passbolt to a new Virtual Machine Appliance.&lt;/p&gt;

    &lt;h2 id=&quot;pre-requisites&quot;&gt;Pre-requisites&lt;/h2&gt;

    &lt;p&gt;For this tutorial, you will need:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Passbolt installed on an old server&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;backup-the-existing-data&quot;&gt;Backup the existing data&lt;/h2&gt;

    &lt;p&gt;Prior to the migration you will need to backup the existing passbolt instance data. Please refer to &lt;a href=&quot;/hosting/backup&quot;&gt;the official backup documentations&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Depending on your SSL configuration you might need to copy the certificate and key from the existing instance. If you are using let’s encrypt you can continue you’ll configure it later directly in the new server.&lt;/p&gt;

    &lt;p&gt;Don’t delete the existing instance yet!&lt;/p&gt;

    &lt;h2 id=&quot;prepare-the-virtual-machine-appliance-for-migration&quot;&gt;Prepare the Virtual Machine Appliance for migration&lt;/h2&gt;

    &lt;div class=&quot;message warning&quot;&gt;
    &lt;p&gt;
        While configuring the database ensure you are configuring the database as it was on your previous server, check the backup of the file passbolt.php for the configuration details.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;p&gt;Passbolt Pro provides a virtual appliance in OVA format. Users can import this appliance on their private virtualization platform and start enjoying Passbolt Pro.
The VM includes the following software:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Debian 10&lt;/li&gt;
      &lt;li&gt;Nginx&lt;/li&gt;
      &lt;li&gt;Php-fpm&lt;/li&gt;
      &lt;li&gt;Mariadb&lt;/li&gt;
      &lt;li&gt;Passbolt Pro preinstalled&lt;/li&gt;
      &lt;li&gt;certbot&lt;/li&gt;
      &lt;li&gt;haveged to fill the entropy pool faster&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;getting-started-with-passbolt-pro-vm&quot;&gt;1. Getting started with Passbolt Pro VM&lt;/h2&gt;

    &lt;h3 id=&quot;download&quot;&gt;1.1 Download&lt;/h3&gt;

    &lt;p&gt;Download the ova and the SHA512SUM.txt:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.passbolt.com/pro/download/vm/debian/latest&quot;&gt;Passbolt Pro VM&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.passbolt.com/pro/download/vm/debian/latest-checksum&quot;&gt;SHA512SUM.txt&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;Import the ova file using virtualbox, vmware (ESXi &amp;gt;= 6.0) or any other platform that supports import OVA files.&lt;/p&gt;

    &lt;p&gt;Once imported into users should be able to boot the VM and just point to the VM ip address with their web browser to initiate the passbolt install process.&lt;/p&gt;

    &lt;h3 id=&quot;credentials&quot;&gt;1.2 Credentials&lt;/h3&gt;

    &lt;p&gt;The appliance performs some actions on the first boot:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Creates ssh host keys&lt;/li&gt;
      &lt;li&gt;Enables ssh&lt;/li&gt;
      &lt;li&gt;Creates a set of random mariadb credentials for the mariadb server installed on the appliance&lt;/li&gt;
      &lt;li&gt;Creates an empty database where passbolt can be installed.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;For the first login the appliance comes with the following ssh default credentials:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;VM login credentials:
username: passbolt
password: admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;The &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;passbolt&lt;/code&gt; user is part of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo&lt;/code&gt; group. There is no root password, so you cannot
login in as root. You can however create a shell as root with the default user:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;configure-the-ova-services&quot;&gt;Configure the OVA Services&lt;/h2&gt;

    &lt;p&gt;Reconfigure the Passbolt package:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo dpkg-reconfigure passbolt-pro-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;configure-mariadb&quot;&gt;Configure mariadb&lt;/h4&gt;

    &lt;p&gt;If not instructed otherwise passbolt debian package will install mariadb-server locally. This step will help you create
an empty mariadb database for passbolt to use.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/configure_mysql_pro.png&quot; alt=&quot;Configure mariadb dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Configure mariadb dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;The configuration process will ask you for the credentials of the mariadb admin user to create a new database.
You will find the root password on the server in the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/.mysql_credentials&lt;/code&gt;.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pro.png&quot; alt=&quot;Mariadb admin user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pass_pro.png&quot; alt=&quot;Mariadb admin user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Now we need to create a mariadb user with reduced permissions for passbolt to connect. For the passbolt database user and password, reuse the ones you have in your backup of passbolt.php.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_name_pro.png&quot; alt=&quot;Mariadb passbolt user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_pass_pro.png&quot; alt=&quot;Mariadb passbolt user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Lastly we need to create a database for passbolt to use, for that we need to name it:&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/db_name_pro.png&quot; alt=&quot;Mariadb database name dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb database name dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Depending on your needs there are two different options to setup nginx and SSL using the debian package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/auto.html&quot;&gt;Auto (Using Let’s Encrypt)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/manual.html&quot;&gt;Manual (Using user-provided SSL certificates)&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;Once you’re done, restart the nginx server:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo systemctl restart nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;migrate-the-data&quot;&gt;Migrate the data&lt;/h2&gt;

    &lt;p&gt;Load the backup files into the new Debian server, for the following tasks we will consider that the backup files are in your user home directory &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/backup&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;You should have:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;Your subscription key&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;the private and public GPG key&lt;/li&gt;
      &lt;li&gt;Your database dump&lt;/li&gt;
      &lt;li&gt;The avatar archive file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;passbolt-avatars.tar.gz&lt;/code&gt; if you are coming from Passbolt prior to 3.2&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Create the subscription key file&lt;/p&gt;

    &lt;p&gt;You received your subscription key by email, copy it as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passbolt/subscription_key.txt&lt;/code&gt; on your server.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt; Restore Passbolt configuration file and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/passbolt.php /etc/passbolt
sudo chown www-data:www-data /etc/passbolt/passbolt.php
sudo chmod 440 /etc/passbolt/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt; Restore GPG public and private keys and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/serverkey.asc /etc/passbolt/gpg
sudo mv ~/backup/serverkey_private.asc /etc/passbolt/gpg
sudo chown www-data: /etc/passbolt/gpg/serverkey_private.asc
sudo chown www-data: /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt; Extract the passbolt-avatars.tar.gz archive and set correct rights (if coming from Passbolt version prior to 3.2)&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo tar xzf passbolt-avatars.tar.gz -C /usr/share/php/passbolt/
sudo chown -R www-data:www-data /usr/share/php/passbolt/webroot/img/public
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt; Load the database&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u PASSBOLT_DATABASE_USER -p PASSBOLT_DATABASE &amp;lt; passbolt-backup.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 6.&lt;/strong&gt; Migrate the Passbolt data to the latest version&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt migrate&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 7.&lt;/strong&gt; Test passbolt&lt;/p&gt;

    &lt;p&gt;Try to access your passbolt application with your browser.&lt;/p&gt;

    &lt;p&gt;If you are encountering any issues, you can run the following command to assess the status of your instance:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt healthcheck&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
16th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="upgrade" /><category term="pro" /><summary type="html"></summary></entry><entry><title type="html">Migrate an existing Passbolt PRO to a new Debian server</title><link href="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-debian-server.html" rel="alternate" type="text/html" title="Migrate an existing Passbolt PRO to a new Debian server" /><published>2021-09-16T02:00:00+02:00</published><updated>2021-09-16T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-debian-server</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-debian-server.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This document describes how to migrate an existing passbolt to a new Debian server.&lt;/p&gt;

    &lt;h2 id=&quot;pre-requisites&quot;&gt;Pre-requisites&lt;/h2&gt;

    &lt;p&gt;For this tutorial, you will need:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Passbolt installed on an old server&lt;/li&gt;
      &lt;li&gt;A minimal Debian 10 new server&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;backup-the-existing-data&quot;&gt;Backup the existing data&lt;/h2&gt;

    &lt;p&gt;Prior to the migration you will need to backup the existing passbolt instance data. Please refer to &lt;a href=&quot;/hosting/backup&quot;&gt;the official backup documentations&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Depending on your SSL configuration you might need to copy the certificate and key from the existing instance. If you are using let’s encrypt you can continue you’ll configure it later directly in the new server.&lt;/p&gt;

    &lt;p&gt;Don’t delete the existing instance yet!&lt;/p&gt;

    &lt;h2 id=&quot;prepare-the-new-debian-server&quot;&gt;Prepare the new Debian server&lt;/h2&gt;

    &lt;h2 id=&quot;install-the-server-components&quot;&gt;1. Install the server components&lt;/h2&gt;
    &lt;h3 id=&quot;package-repository-setup&quot;&gt;1.1. Package repository setup&lt;/h3&gt;

    &lt;p&gt;For easier installation and update tasks Passbolt provides a package repository that you need to setup
before you download Passbolt PRO and install it.&lt;/p&gt;

    &lt;p&gt;These steps assume you have already installed sudo and added your user to the sudo group.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Update the apt indexes and install packages to allow apt to use https repositories:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Optionally you can install certbot to enable &lt;a href=&quot;https://letsencrypt.org/&quot;&gt;Let’s Encrypt&lt;/a&gt; configuration:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install certbot python3-certbot-nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt;  Add Passbolt package official GnuPG key
From keys.mailvelope.com:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.mailvelope.com --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from pgp.mit.edu:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://pgp.mit.edu --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from keys.gnupg.net:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.gnupg.net --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt;  Check that the GPG fingerprint matches &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D&lt;/code&gt;&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key fingerprint 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pub   rsa2048 2020-05-18 [SC] [expires: 2022-05-18]
      3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D
uid           [ unknown] Passbolt SA package signing key &amp;lt;contact@passbolt.com&amp;gt;
sub   rsa2048 2020-05-18 [E] [expires: 2022-05-18]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt;  Add passbolt repository to your apt lists:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo  &quot;deb https://download.passbolt.com/pro/debian buster stable&quot; | \
sudo tee /etc/apt/sources.list.d/passbolt.list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt;  Update the apt indexes with the new passbolt apt repository:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;install-passbolt&quot;&gt;1.2. Install passbolt&lt;/h3&gt;

    &lt;p&gt;By default, passbolt Debian package will install Passbolt server component, mariadb-server, php-fpm and nginx
as dependencies.&lt;/p&gt;

    &lt;p&gt;There are two main ways to install the passbolt Debian package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Interactive&lt;/strong&gt;: the package will guide the user through a set of questions to setup mariadb and nginx. If you are
going to use existing SSL certs for the web server, they need to be created and installed to the location of your choosing before
beginning. The user will be asked for the path and name of the certificate and key.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Non-interactive&lt;/strong&gt;: no questions will be asked. Useful for users with specific needs or users that want to automate the
installation. &lt;a href=&quot;/faq/hosting/how-to-install-passbolt-non-interactive&quot;&gt;Read this FAQ page to know more&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h4 id=&quot;install-passbolt-package&quot;&gt;Install passbolt package&lt;/h4&gt;

    &lt;p&gt;Install the main passbolt server component:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install passbolt-pro-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;configure-mariadb&quot;&gt;Configure mariadb&lt;/h4&gt;

    &lt;p&gt;If not instructed otherwise passbolt debian package will install mariadb-server locally. This step will help you create
an empty mariadb database for passbolt to use.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/configure_mysql_pro.png&quot; alt=&quot;Configure mariadb dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Configure mariadb dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;The configuration process will ask you for the credentials of the mariadb admin user to create a new database.
You will find the root password on the server in the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/.mysql_credentials&lt;/code&gt;.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pro.png&quot; alt=&quot;Mariadb admin user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pass_pro.png&quot; alt=&quot;Mariadb admin user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Now we need to create a mariadb user with reduced permissions for passbolt to connect. For the passbolt database user and password, reuse the ones you have in your backup of passbolt.php.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_name_pro.png&quot; alt=&quot;Mariadb passbolt user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_pass_pro.png&quot; alt=&quot;Mariadb passbolt user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Lastly we need to create a database for passbolt to use, for that we need to name it:&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/db_name_pro.png&quot; alt=&quot;Mariadb database name dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb database name dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;h2 id=&quot;configure-nginx-for-serving-https&quot;&gt;Configure nginx for serving HTTPS&lt;/h2&gt;

    &lt;p&gt;Depending on your needs there are two different options to setup nginx and SSL using the Debian package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/auto.html&quot;&gt;Auto (Using Let’s Encrypt)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/manual.html&quot;&gt;Manual (Using user-provided SSL certificates)&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;migrate-the-data&quot;&gt;Migrate the data&lt;/h2&gt;

    &lt;p&gt;Load the backup files into the new Debian server, for the following tasks we will consider that the backup files are in your user home directory &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/backup&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;You should have:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;Your subscription key&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;the private and public GPG key&lt;/li&gt;
      &lt;li&gt;Your database dump&lt;/li&gt;
      &lt;li&gt;The avatar archive file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;passbolt-avatars.tar.gz&lt;/code&gt; if you are coming from Passbolt prior to 3.2&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Create the subscription key file&lt;/p&gt;

    &lt;p&gt;You received your subscription key by email, copy it as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passbolt/subscription_key.txt&lt;/code&gt; on your server.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt; Restore Passbolt configuration file and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/passbolt.php /etc/passbolt
sudo chown www-data:www-data /etc/passbolt/passbolt.php
sudo chmod 440 /etc/passbolt/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt; Restore GPG public and private keys and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/serverkey.asc /etc/passbolt/gpg
sudo mv ~/backup/serverkey_private.asc /etc/passbolt/gpg
sudo chown www-data: /etc/passbolt/gpg/serverkey_private.asc
sudo chown www-data: /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt; Extract the passbolt-avatars.tar.gz archive and set correct rights (if coming from Passbolt version prior to 3.2)&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo tar xzf passbolt-avatars.tar.gz -C /usr/share/php/passbolt/
sudo chown -R www-data:www-data /usr/share/php/passbolt/webroot/img/public
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt; Load the database&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u PASSBOLT_DATABASE_USER -p PASSBOLT_DATABASE &amp;lt; passbolt-backup.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 6.&lt;/strong&gt; Migrate the Passbolt data to the latest version&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt migrate&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 7.&lt;/strong&gt; Test passbolt&lt;/p&gt;

    &lt;p&gt;Try to access your passbolt application with your browser.&lt;/p&gt;

    &lt;p&gt;If you are encountering any issues, you can run the following command to assess the status of your instance:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt healthcheck&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
16th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="upgrade" /><category term="pro" /><summary type="html"></summary></entry><entry><title type="html">Migrate an existing Passbolt CE to a new Ubuntu server</title><link href="https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-ubuntu-server.html" rel="alternate" type="text/html" title="Migrate an existing Passbolt CE to a new Ubuntu server" /><published>2021-09-16T02:00:00+02:00</published><updated>2021-09-16T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-ubuntu-server</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-ubuntu-server.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This document describes how to migrate an existing passbolt to a new Ubuntu server.&lt;/p&gt;

    &lt;h2 id=&quot;pre-requisites&quot;&gt;Pre-requisites&lt;/h2&gt;

    &lt;p&gt;For this tutorial, you will need:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Passbolt installed on an old server&lt;/li&gt;
      &lt;li&gt;A minimal Ubuntu 20.04 new server&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;backup-the-existing-data&quot;&gt;Backup the existing data&lt;/h2&gt;

    &lt;p&gt;Prior to the migration you will need to backup the existing passbolt instance data. Please refer to &lt;a href=&quot;/hosting/backup&quot;&gt;the official backup documentations&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Depending on your SSL configuration you might need to copy the certificate and key from the existing instance. If you are using let’s encrypt you can continue you’ll configure it later directly in the new server.&lt;/p&gt;

    &lt;p&gt;Don’t delete the existing instance yet!&lt;/p&gt;

    &lt;h2 id=&quot;prepare-the-new-ubuntu-server&quot;&gt;Prepare the new Ubuntu server&lt;/h2&gt;

    &lt;h2 id=&quot;install-the-server-components&quot;&gt;1. Install the server components&lt;/h2&gt;
    &lt;h3 id=&quot;package-repository-setup&quot;&gt;1.1. Package repository setup&lt;/h3&gt;

    &lt;p&gt;For easier installation and update tasks Passbolt provides a package repository that you need to setup
before you download Passbolt CE and install it.&lt;/p&gt;

    &lt;p&gt;These steps assume you have already installed sudo and added your user to the sudo group.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Update the apt indexes and install packages to allow apt to use https repositories:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Optionally you can install certbot to enable &lt;a href=&quot;https://letsencrypt.org/&quot;&gt;Let’s Encrypt&lt;/a&gt; configuration:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install certbot python3-certbot-nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt;  Add Passbolt package official GnuPG key
From keys.mailvelope.com:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.mailvelope.com --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from pgp.mit.edu:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://pgp.mit.edu --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from keys.gnupg.net:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.gnupg.net --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt;  Check that the GPG fingerprint matches &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D&lt;/code&gt;&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key fingerprint 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pub   rsa2048 2020-05-18 [SC] [expires: 2022-05-18]
      3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D
uid           [ unknown] Passbolt SA package signing key &amp;lt;contact@passbolt.com&amp;gt;
sub   rsa2048 2020-05-18 [E] [expires: 2022-05-18]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt;  Add passbolt repository to your apt lists:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo  &quot;deb https://download.passbolt.com/ce/ubuntu focal stable&quot; | \
sudo tee /etc/apt/sources.list.d/passbolt.list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt;  Update the apt indexes with the new passbolt apt repository:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;install-passbolt&quot;&gt;1.2. Install passbolt&lt;/h3&gt;

    &lt;p&gt;By default, passbolt Ubuntu package will install Passbolt server component, mariadb-server, php-fpm and nginx
as dependencies.&lt;/p&gt;

    &lt;p&gt;There are two main ways to install the passbolt Ubuntu package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Interactive&lt;/strong&gt;: the package will guide the user through a set of questions to setup mariadb and nginx. If you are
going to use existing SSL certs for the web server, they need to be created and installed to the location of your choosing before
beginning. The user will be asked for the path and name of the certificate and key.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Non-interactive&lt;/strong&gt;: no questions will be asked. Useful for users with specific needs or users that want to automate the
installation. &lt;a href=&quot;/faq/hosting/how-to-install-passbolt-non-interactive&quot;&gt;Read this FAQ page to know more&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h4 id=&quot;install-passbolt-package&quot;&gt;Install passbolt package&lt;/h4&gt;

    &lt;p&gt;Install the main passbolt server component:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install passbolt-ce-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;configure-mariadb&quot;&gt;Configure mariadb&lt;/h4&gt;

    &lt;p&gt;If not instructed otherwise passbolt ubuntu package will install mariadb-server locally. This step will help you create
an empty mariadb database for passbolt to use.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/configure_mysql.png&quot; alt=&quot;Configure mariadb dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Configure mariadb dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;The configuration process will ask you for the credentials of the mariadb admin user to create a new database.
You will find the root password on the server in the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/.mysql_credentials&lt;/code&gt;.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user.png&quot; alt=&quot;Mariadb admin user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pass.png&quot; alt=&quot;Mariadb admin user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Now we need to create a mariadb user with reduced permissions for passbolt to connect. For the passbolt database user and password, reuse the ones you have in your backup of passbolt.php.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_name.png&quot; alt=&quot;Mariadb passbolt user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_pass.png&quot; alt=&quot;Mariadb passbolt user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Lastly we need to create a database for passbolt to use, for that we need to name it:&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/db_name.png&quot; alt=&quot;Mariadb database name dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb database name dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;h2 id=&quot;configure-nginx-for-serving-https&quot;&gt;Configure nginx for serving HTTPS&lt;/h2&gt;

    &lt;p&gt;Depending on your needs there are two different options to setup nginx and SSL using the Ubuntu package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/ce/debian/auto.html&quot;&gt;Auto (Using Let’s Encrypt)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/ce/debian/manual.html&quot;&gt;Manual (Using user-provided SSL certificates)&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;migrate-the-data&quot;&gt;Migrate the data&lt;/h2&gt;

    &lt;p&gt;Load the backup files into the new Ubuntu server, for the following tasks we will consider that the backup files are in your user home directory &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/backup&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;You should have:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;the private and public GPG key&lt;/li&gt;
      &lt;li&gt;Your database dump&lt;/li&gt;
      &lt;li&gt;The avatar archive file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;passbolt-avatars.tar.gz&lt;/code&gt; if you are coming from Passbolt prior to 3.2&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Restore Passbolt configuration file and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/passbolt.php /etc/passbolt
sudo chown www-data:www-data /etc/passbolt/passbolt.php
sudo chmod 440 /etc/passbolt/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt; Restore GPG public and private keys and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/serverkey.asc /etc/passbolt/gpg
sudo mv ~/backup/serverkey_private.asc /etc/passbolt/gpg
sudo chown www-data: /etc/passbolt/gpg/serverkey_private.asc
sudo chown www-data: /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt; Extract the passbolt-avatars.tar.gz archive and set correct rights (if coming from Passbolt version prior to 3.2)&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo tar xzf passbolt-avatars.tar.gz -C /usr/share/php/passbolt/
sudo chown -R www-data:www-data /usr/share/php/passbolt/webroot/img/public
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt; Load the database&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u PASSBOLT_DATABASE_USER -p PASSBOLT_DATABASE &amp;lt; passbolt-backup.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt; Migrate the Passbolt data to the latest version&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt migrate&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 6.&lt;/strong&gt; Test passbolt&lt;/p&gt;

    &lt;p&gt;Try to access your passbolt application with your browser.&lt;/p&gt;

    &lt;p&gt;If you are encountering any issues, you can run the following command to assess the status of your instance:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt healthcheck&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
16th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="upgrade" /><category term="ce" /><summary type="html"></summary></entry><entry><title type="html">Migrate an existing Passbolt CE to a new Debian server</title><link href="https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-debian-server.html" rel="alternate" type="text/html" title="Migrate an existing Passbolt CE to a new Debian server" /><published>2021-09-16T02:00:00+02:00</published><updated>2021-09-16T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-debian-server</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/ce/migrate-existing-ce-to-debian-server.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This document describes how to migrate an existing passbolt to a new Debian server.&lt;/p&gt;

    &lt;h2 id=&quot;pre-requisites&quot;&gt;Pre-requisites&lt;/h2&gt;

    &lt;p&gt;For this tutorial, you will need:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Passbolt installed on an old server&lt;/li&gt;
      &lt;li&gt;A minimal Debian 10 new server&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;backup-the-existing-data&quot;&gt;Backup the existing data&lt;/h2&gt;

    &lt;p&gt;Prior to the migration you will need to backup the existing passbolt instance data. Please refer to &lt;a href=&quot;/hosting/backup&quot;&gt;the official backup documentations&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Depending on your SSL configuration you might need to copy the certificate and key from the existing instance. If you are using let’s encrypt you can continue you’ll configure it later directly in the new server.&lt;/p&gt;

    &lt;p&gt;Don’t delete the existing instance yet!&lt;/p&gt;

    &lt;h2 id=&quot;prepare-the-new-debian-server&quot;&gt;Prepare the new Debian server&lt;/h2&gt;

    &lt;h2 id=&quot;install-the-server-components&quot;&gt;1. Install the server components&lt;/h2&gt;
    &lt;h3 id=&quot;package-repository-setup&quot;&gt;1.1. Package repository setup&lt;/h3&gt;

    &lt;p&gt;For easier installation and update tasks Passbolt provides a package repository that you need to setup
before you download Passbolt CE and install it.&lt;/p&gt;

    &lt;p&gt;These steps assume you have already installed sudo and added your user to the sudo group.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Update the apt indexes and install packages to allow apt to use https repositories:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Optionally you can install certbot to enable &lt;a href=&quot;https://letsencrypt.org/&quot;&gt;Let’s Encrypt&lt;/a&gt; configuration:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install certbot python3-certbot-nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt;  Add Passbolt package official GnuPG key
From keys.mailvelope.com:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.mailvelope.com --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from pgp.mit.edu:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://pgp.mit.edu --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from keys.gnupg.net:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.gnupg.net --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt;  Check that the GPG fingerprint matches &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D&lt;/code&gt;&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key fingerprint 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pub   rsa2048 2020-05-18 [SC] [expires: 2022-05-18]
      3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D
uid           [ unknown] Passbolt SA package signing key &amp;lt;contact@passbolt.com&amp;gt;
sub   rsa2048 2020-05-18 [E] [expires: 2022-05-18]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt;  Add passbolt repository to your apt lists:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo  &quot;deb https://download.passbolt.com/ce/debian buster stable&quot; | \
sudo tee /etc/apt/sources.list.d/passbolt.list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt;  Update the apt indexes with the new passbolt apt repository:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;install-passbolt&quot;&gt;1.2. Install passbolt&lt;/h3&gt;

    &lt;p&gt;By default, passbolt Debian package will install Passbolt server component, mariadb-server, php-fpm and nginx
as dependencies.&lt;/p&gt;

    &lt;p&gt;There are two main ways to install the passbolt Debian package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Interactive&lt;/strong&gt;: the package will guide the user through a set of questions to setup mariadb and nginx. If you are
going to use existing SSL certs for the web server, they need to be created and installed to the location of your choosing before
beginning. The user will be asked for the path and name of the certificate and key.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Non-interactive&lt;/strong&gt;: no questions will be asked. Useful for users with specific needs or users that want to automate the
installation. &lt;a href=&quot;/faq/hosting/how-to-install-passbolt-non-interactive&quot;&gt;Read this FAQ page to know more&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h4 id=&quot;install-passbolt-package&quot;&gt;Install passbolt package&lt;/h4&gt;

    &lt;p&gt;Install the main passbolt server component:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install passbolt-ce-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;configure-mariadb&quot;&gt;Configure mariadb&lt;/h4&gt;

    &lt;p&gt;If not instructed otherwise passbolt debian package will install mariadb-server locally. This step will help you create
an empty mariadb database for passbolt to use.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/configure_mysql.png&quot; alt=&quot;Configure mariadb dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Configure mariadb dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;The configuration process will ask you for the credentials of the mariadb admin user to create a new database.
You will find the root password on the server in the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/.mysql_credentials&lt;/code&gt;.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user.png&quot; alt=&quot;Mariadb admin user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pass.png&quot; alt=&quot;Mariadb admin user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Now we need to create a mariadb user with reduced permissions for passbolt to connect. For the passbolt database user and password, reuse the ones you have in your backup of passbolt.php.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_name.png&quot; alt=&quot;Mariadb passbolt user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_pass.png&quot; alt=&quot;Mariadb passbolt user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Lastly we need to create a database for passbolt to use, for that we need to name it:&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/db_name.png&quot; alt=&quot;Mariadb database name dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb database name dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;h2 id=&quot;configure-nginx-for-serving-https&quot;&gt;Configure nginx for serving HTTPS&lt;/h2&gt;

    &lt;p&gt;Depending on your needs there are two different options to setup nginx and SSL using the Debian package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/ce/debian/auto.html&quot;&gt;Auto (Using Let’s Encrypt)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/ce/debian/manual.html&quot;&gt;Manual (Using user-provided SSL certificates)&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;migrate-the-data&quot;&gt;Migrate the data&lt;/h2&gt;

    &lt;p&gt;Load the backup files into the new Debian server, for the following tasks we will consider that the backup files are in your user home directory &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/backup&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;You should have:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;the private and public GPG key&lt;/li&gt;
      &lt;li&gt;Your database dump&lt;/li&gt;
      &lt;li&gt;The avatar archive file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;passbolt-avatars.tar.gz&lt;/code&gt; if you are coming from Passbolt prior to 3.2&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Restore Passbolt configuration file and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/passbolt.php /etc/passbolt
sudo chown www-data:www-data /etc/passbolt/passbolt.php
sudo chmod 440 /etc/passbolt/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt; Restore GPG public and private keys and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/serverkey.asc /etc/passbolt/gpg
sudo mv ~/backup/serverkey_private.asc /etc/passbolt/gpg
sudo chown www-data: /etc/passbolt/gpg/serverkey_private.asc
sudo chown www-data: /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt; Extract the passbolt-avatars.tar.gz archive and set correct rights (if coming from Passbolt version prior to 3.2)&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo tar xzf passbolt-avatars.tar.gz -C /usr/share/php/passbolt/
sudo chown -R www-data:www-data /usr/share/php/passbolt/webroot/img/public
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt; Load the database&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u PASSBOLT_DATABASE_USER -p PASSBOLT_DATABASE &amp;lt; passbolt-backup.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt; Migrate the Passbolt data to the latest version&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt migrate&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 6.&lt;/strong&gt; Test passbolt&lt;/p&gt;

    &lt;p&gt;Try to access your passbolt application with your browser.&lt;/p&gt;

    &lt;p&gt;If you are encountering any issues, you can run the following command to assess the status of your instance:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt healthcheck&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
16th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="upgrade" /><category term="ce" /><summary type="html"></summary></entry><entry><title type="html">Ubuntu package</title><link href="https://help.passbolt.com/hosting/backup/ubuntu.html" rel="alternate" type="text/html" title="Ubuntu package" /><published>2021-09-16T02:00:00+02:00</published><updated>2021-09-16T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/backup/ubuntu</id><content type="html" xml:base="https://help.passbolt.com/hosting/backup/ubuntu.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;Making regular backups is a critical aspect of managing a passbolt instance. Because passbolt stores important
information, it is equally important to have a backup strategy in place.&lt;/p&gt;

    &lt;p&gt;As a passbolt administrator it is your responsibility to define how often and when to perform backups.
Please automate and customize this process to match the needs and policies of your organization.&lt;/p&gt;

    &lt;p&gt;Here are some best practices to keep in mind:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Ensure that the backups are taken at intervals that match your usage&lt;/li&gt;
      &lt;li&gt;Take these backups off-site, or to another environment than the live one&lt;/li&gt;
      &lt;li&gt;Make sure the backup is encrypted and stored in a safe location&lt;/li&gt;
      &lt;li&gt;Practice drills and test the backups to make sure they work&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;what-to-backup&quot;&gt;What to backup?&lt;/h2&gt;

    &lt;p&gt;If you are a PRO user, ensure you have a backup of your subscription key.&lt;/p&gt;

    &lt;p&gt;There are also several elements you need to backup:&lt;/p&gt;

    &lt;h4 id=&quot;the-database&quot;&gt;1. The database&lt;/h4&gt;

    &lt;p&gt;This can be easily scripted using &lt;a href=&quot;https://mariadb.com/kb/en/mariadb/mysqldump/&quot;&gt;mysqldump&lt;/a&gt; for example:&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysqldump &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;user] &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;pass] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;db] &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /path/to/backup.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;the-server-public-and-private-keys&quot;&gt;2. The server public and private keys&lt;/h4&gt;

    &lt;p&gt;The GPG server keys are stored under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passbolt/gpg/&lt;/code&gt; folder:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;private key is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;serverkey_private.asc&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;public key is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;serverkey.asc&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h4 id=&quot;the-application-configuration&quot;&gt;3. The application configuration&lt;/h4&gt;

    &lt;p&gt;Passbolt ubuntu package stores all configuration files under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passbolt/*&lt;/code&gt; but the one you need is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passbolt/passbolt.php&lt;/code&gt;&lt;/p&gt;

    &lt;h4 id=&quot;the-avatars-for-passbolt-version-prior-to-32&quot;&gt;4. The avatars (for Passbolt version prior to 3.2)&lt;/h4&gt;

    &lt;div class=&quot;message notice&quot;&gt;
    &lt;p&gt;
    Since Passbolt 3.2, user’s avatars are no longer stored on disk but on the avatars table of passbolt database.
    &lt;/p&gt;
    
&lt;/div&gt;

    &lt;p&gt;Back up &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/share/php/passbolt/webroot/img/avatar&lt;/code&gt; to avoid losing
the profile images.&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo tar &lt;/span&gt;cvfzp passbolt-avatars.tar.gz &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; /usr/share/php/passbolt/ webroot/img/avatar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h2 id=&quot;backup-list&quot;&gt;Backup list&lt;/h2&gt;

    &lt;p&gt;At the end of the backup process you should have:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;a dump of your database&lt;/li&gt;
      &lt;li&gt;the server public and private GPG keys&lt;/li&gt;
      &lt;li&gt;a copy of your config/passbolt.php configuration file&lt;/li&gt;
      &lt;li&gt;a copy of your avatar folder (&lt;strong&gt;only if Passbolt version &amp;lt; 3.2&lt;/strong&gt;)&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;what-about-the-secret-keys-of-my-collaborators&quot;&gt;What about the secret keys of my collaborators?&lt;/h2&gt;

    &lt;p&gt;Every user private key should also be backed up, this is however not something we/you can automate easily for now (passbolt might provide a functionality for this in the future). We believe it is best if this is the responsibility of the end user. There is a dedicated step during the extension setup to that purpose.&lt;/p&gt;

    &lt;p&gt;As an administrator you should stress the importance of backing up secret keys to other users. For example this warning could be part of the initial information message sent to introduce passbolt to new users.&lt;/p&gt;

    &lt;p&gt;It is possible that having users back up their own keys may not be realistic or desirable in your case. In this case you can opt in for an alternative strategy such as setting up the account with/for them and taking a backup of the secret keys then. In the worst case scenario you could automate the process by installing a script on your users machine that would make that backup for you.&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
16th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Do you have a question about backups? Do you want to share your experience and best practices?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Get in touch!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="backup" /><summary type="html"></summary></entry><entry><title type="html">Migrate an existing Passbolt PRO to a new Ubuntu server</title><link href="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-ubuntu-server.html" rel="alternate" type="text/html" title="Migrate an existing Passbolt PRO to a new Ubuntu server" /><published>2021-09-16T02:00:00+02:00</published><updated>2021-09-16T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-ubuntu-server</id><content type="html" xml:base="https://help.passbolt.com/hosting/upgrade/pro/migrate-existing-pro-to-ubuntu-server.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;

    &lt;p&gt;This document describes how to migrate an existing passbolt to a new Ubuntu server.&lt;/p&gt;

    &lt;h2 id=&quot;pre-requisites&quot;&gt;Pre-requisites&lt;/h2&gt;

    &lt;p&gt;For this tutorial, you will need:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;Passbolt installed on an old server&lt;/li&gt;
      &lt;li&gt;A minimal Ubuntu 20.04 new server&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;backup-the-existing-data&quot;&gt;Backup the existing data&lt;/h2&gt;

    &lt;p&gt;Prior to the migration you will need to backup the existing passbolt instance data. Please refer to &lt;a href=&quot;/hosting/backup&quot;&gt;the official backup documentations&lt;/a&gt;.&lt;/p&gt;

    &lt;p&gt;Depending on your SSL configuration you might need to copy the certificate and key from the existing instance. If you are using let’s encrypt you can continue you’ll configure it later directly in the new server.&lt;/p&gt;

    &lt;p&gt;Don’t delete the existing instance yet!&lt;/p&gt;

    &lt;h2 id=&quot;prepare-the-new-ubuntu-server&quot;&gt;Prepare the new Ubuntu server&lt;/h2&gt;

    &lt;h2 id=&quot;install-the-server-components&quot;&gt;1. Install the server components&lt;/h2&gt;
    &lt;h3 id=&quot;package-repository-setup&quot;&gt;1.1. Package repository setup&lt;/h3&gt;

    &lt;p&gt;For easier installation and update tasks Passbolt provides a package repository that you need to setup
before you download Passbolt PRO and install it.&lt;/p&gt;

    &lt;p&gt;These steps assume you have already installed sudo and added your user to the sudo group.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Update the apt indexes and install packages to allow apt to use https repositories:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Optionally you can install certbot to enable &lt;a href=&quot;https://letsencrypt.org/&quot;&gt;Let’s Encrypt&lt;/a&gt; configuration:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install certbot python3-certbot-nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt;  Add Passbolt package official GnuPG key
From keys.mailvelope.com:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.mailvelope.com --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from pgp.mit.edu:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://pgp.mit.edu --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Or from keys.gnupg.net:&lt;/p&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key adv --keyserver hkps://keys.gnupg.net --recv-keys 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt;  Check that the GPG fingerprint matches &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D&lt;/code&gt;&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-key fingerprint 0xDE8B853FC155581D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pub   rsa2048 2020-05-18 [SC] [expires: 2022-05-18]
      3D1A 0346 C8E1 802F 774A  EF21 DE8B 853F C155 581D
uid           [ unknown] Passbolt SA package signing key &amp;lt;contact@passbolt.com&amp;gt;
sub   rsa2048 2020-05-18 [E] [expires: 2022-05-18]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt;  Add passbolt repository to your apt lists:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo  &quot;deb https://download.passbolt.com/pro/ubuntu focal stable&quot; | \
sudo tee /etc/apt/sources.list.d/passbolt.list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt;  Update the apt indexes with the new passbolt apt repository:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h3 id=&quot;install-passbolt&quot;&gt;1.2. Install passbolt&lt;/h3&gt;

    &lt;p&gt;By default, passbolt Ubuntu package will install Passbolt server component, mariadb-server, php-fpm and nginx
as dependencies.&lt;/p&gt;

    &lt;p&gt;There are two main ways to install the passbolt Ubuntu package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Interactive&lt;/strong&gt;: the package will guide the user through a set of questions to setup mariadb and nginx. If you are
going to use existing SSL certs for the web server, they need to be created and installed to the location of your choosing before
beginning. The user will be asked for the path and name of the certificate and key.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Non-interactive&lt;/strong&gt;: no questions will be asked. Useful for users with specific needs or users that want to automate the
installation. &lt;a href=&quot;/faq/hosting/how-to-install-passbolt-non-interactive&quot;&gt;Read this FAQ page to know more&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h4 id=&quot;install-passbolt-package&quot;&gt;Install passbolt package&lt;/h4&gt;

    &lt;p&gt;Install the main passbolt server component:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo apt-get install passbolt-pro-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;h4 id=&quot;configure-mariadb&quot;&gt;Configure mariadb&lt;/h4&gt;

    &lt;p&gt;If not instructed otherwise passbolt ubuntu package will install mariadb-server locally. This step will help you create
an empty mariadb database for passbolt to use.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/configure_mysql_pro.png&quot; alt=&quot;Configure mariadb dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Configure mariadb dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;The configuration process will ask you for the credentials of the mariadb admin user to create a new database.
You will find the root password on the server in the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/.mysql_credentials&lt;/code&gt;.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pro.png&quot; alt=&quot;Mariadb admin user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/mysql_admin_user_pass_pro.png&quot; alt=&quot;Mariadb admin user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb admin user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Now we need to create a mariadb user with reduced permissions for passbolt to connect. For the passbolt database user and password, reuse the ones you have in your backup of passbolt.php.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_name_pro.png&quot; alt=&quot;Mariadb passbolt user dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/passbolt_db_user_pass_pro.png&quot; alt=&quot;Mariadb passbolt user pass dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb passbolt user pass dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Lastly we need to create a database for passbolt to use, for that we need to name it:&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2020/05/debian-package/db_name_pro.png&quot; alt=&quot;Mariadb database name dialog&quot; style=&quot;max-width:450px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Mariadb database name dialog&lt;/span&gt;
&lt;/figure&gt;

    &lt;h2 id=&quot;configure-nginx-for-serving-https&quot;&gt;Configure nginx for serving HTTPS&lt;/h2&gt;

    &lt;p&gt;Depending on your needs there are two different options to setup nginx and SSL using the Ubuntu package:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/auto.html&quot;&gt;Auto (Using Let’s Encrypt)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/manual.html&quot;&gt;Manual (Using user-provided SSL certificates)&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;migrate-the-data&quot;&gt;Migrate the data&lt;/h2&gt;

    &lt;p&gt;Load the backup files into the new Ubuntu server, for the following tasks we will consider that the backup files are in your user home directory &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/backup&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;You should have:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;Your subscription key&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;the private and public GPG key&lt;/li&gt;
      &lt;li&gt;Your database dump&lt;/li&gt;
      &lt;li&gt;The avatar archive file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;passbolt-avatars.tar.gz&lt;/code&gt; if you are coming from Passbolt prior to 3.2&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;&lt;strong&gt;Step 1.&lt;/strong&gt; Create the subscription key file&lt;/p&gt;

    &lt;p&gt;You received your subscription key by email, copy it as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passbolt/subscription_key.txt&lt;/code&gt; on your server.&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;Step 2.&lt;/strong&gt; Restore Passbolt configuration file and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/passbolt.php /etc/passbolt
sudo chown www-data:www-data /etc/passbolt/passbolt.php
sudo chmod 440 /etc/passbolt/passbolt.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 3.&lt;/strong&gt; Restore GPG public and private keys and ensure rights and ownership are correct:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo mv ~/backup/serverkey.asc /etc/passbolt/gpg
sudo mv ~/backup/serverkey_private.asc /etc/passbolt/gpg
sudo chown www-data: /etc/passbolt/gpg/serverkey_private.asc
sudo chown www-data: /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey.asc
sudo chmod 440 /etc/passbolt/gpg/serverkey_private.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 4.&lt;/strong&gt; Extract the passbolt-avatars.tar.gz archive and set correct rights (if coming from Passbolt version prior to 3.2)&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo tar xzf passbolt-avatars.tar.gz -C /usr/share/php/passbolt/
sudo chown -R www-data:www-data /usr/share/php/passbolt/webroot/img/public
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 5.&lt;/strong&gt; Load the database&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysql -u PASSBOLT_DATABASE_USER -p PASSBOLT_DATABASE &amp;lt; passbolt-backup.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 6.&lt;/strong&gt; Migrate the Passbolt data to the latest version&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt migrate&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;strong&gt;Step 7.&lt;/strong&gt; Test passbolt&lt;/p&gt;

    &lt;p&gt;Try to access your passbolt application with your browser.&lt;/p&gt;

    &lt;p&gt;If you are encountering any issues, you can run the following command to assess the status of your instance:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo -H -u www-data /bin/bash -c &quot;/usr/share/php/passbolt/bin/cake passbolt healthcheck&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
September
16th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues when updating passbolt?&lt;/p&gt;
    
    &lt;a href=&quot;https://community.passbolt.com/c/installation-issues&quot; class=&quot;button primary&quot;&gt;Ask the community!&lt;/a&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message &quot;&gt;
    &lt;p&gt;&lt;/p&gt;
    
&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="upgrade" /><category term="pro" /><summary type="html"></summary></entry><entry><title type="html">Using Passbolt PRO AWS AMI</title><link href="https://help.passbolt.com/hosting/install/pro/aws.html" rel="alternate" type="text/html" title="Using Passbolt PRO AWS AMI" /><published>2021-08-11T02:00:00+02:00</published><updated>2021-08-11T02:00:00+02:00</updated><id>https://help.passbolt.com/hosting/install/pro/aws</id><content type="html" xml:base="https://help.passbolt.com/hosting/install/pro/aws.html">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col7&quot;&gt;
    &lt;p&gt;Passbolt Amazon Machine Image (AMI) provides a ready to use passbolt image that you can
use for free on your Amazon Web Services infrastructure.
The AMI includes the following software:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Debian 10&lt;/li&gt;
      &lt;li&gt;Nginx&lt;/li&gt;
      &lt;li&gt;Php-fpm&lt;/li&gt;
      &lt;li&gt;Mariadb&lt;/li&gt;
      &lt;li&gt;Passbolt PRO preinstalled&lt;/li&gt;
      &lt;li&gt;certbot&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;This AMI does not provide an email server preinstalled so users can manually install it or
leverage on third party email providers.&lt;/p&gt;

    &lt;h2 id=&quot;getting-started-with-passbolt-pro-ami&quot;&gt;1. Getting started with passbolt PRO AMI&lt;/h2&gt;

    &lt;p&gt;You can subscribe to passbolt  PRO on the following &lt;a href=&quot;https://aws.amazon.com/marketplace/pp/prodview-7tuiu3brmboa2&quot;&gt;AWS marketplace listing&lt;/a&gt;. Just
click on “continue to subscribe” button on the listing page.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/08/subscribe-aws-pro.png&quot; alt=&quot;Subscribe to passbolt marketplace&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Subscribe to passbolt marketplace&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;The EULA for the passbolt PRO is the AGPL license you have to accept that in order
to use this image by just clicking on the “Accept terms” button.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/08/accept-terms-aws-pro.png&quot; alt=&quot;Accept AMI terms&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Accept AMI terms&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Once the terms are accepted you can click on “Continue to configuration” button. In the next
screen you will be able to select which version of the AMI you want to use as well as in which AWS region
you want the instance to be launched.
Once you have selected your desired configuration just click on “Continue to Launch” button.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/08/configure-aws-pro.png&quot; alt=&quot;Configure instance region and version&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Configure instance region and version&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;On the launch screen you will be able to select:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;How to launch the instance&lt;/li&gt;
      &lt;li&gt;Instance type&lt;/li&gt;
      &lt;li&gt;VPC&lt;/li&gt;
      &lt;li&gt;Subnet settings&lt;/li&gt;
      &lt;li&gt;Security group settings&lt;/li&gt;
      &lt;li&gt;Key pair settings&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;If you do not know what this fields mean just rely on the defaults making sure that they key pair
is available on your local machine so you can connect through SSH to the instance.
If all the values are good just click on “Launch” button.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/08/launch-aws-pro.png&quot; alt=&quot;Launch instance&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. Launch instance&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;setup-https-optional-but-highly-recommended&quot;&gt;1.1. Setup HTTPS (optional, but highly recommended):&lt;/h3&gt;

    &lt;p&gt;If you are planning to use this AWS instance in production, it is highly recommended to setup SSL. There are two main methods described below:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/auto.html&quot;&gt;Auto (Using Let’s Encrypt)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;/configure/https/pro/debian/manual.html&quot;&gt;Manual (Using user-provided SSL certificates)&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2 id=&quot;configure-passbolt&quot;&gt;2. Configure passbolt&lt;/h2&gt;

    &lt;p&gt;Before you can use the application, you need to configure it. Point your browser to the hostname / ip where passbolt 
can be reached. You will reach a getting started page.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/02/web-installer-getting-started.png&quot; alt=&quot;passbolt welcome page before configuration&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. passbolt welcome page before configuration&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;healthcheck&quot;&gt;2.1. Healthcheck&lt;/h3&gt;

    &lt;p&gt;The first page of the wizard will tell you if your environment is ready for passbolt. Solve issues if any and click on
“Start configuration” when ready.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-healthcheck.png&quot; alt=&quot;wizard - healthcheck&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - healthcheck&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;subscription-key&quot;&gt;2.2. Subscription key&lt;/h3&gt;

    &lt;p&gt;At this step, the wizard will ask you for your subscription key. You should have received it by email soon after 
your online purchase. Enter it in the box.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-subscription-key.png&quot; alt=&quot;wizard - subscription key&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - subscription key&lt;/span&gt;
&lt;/figure&gt;

    &lt;h2 id=&quot;database&quot;&gt;2.3. Database&lt;/h2&gt;

    &lt;p&gt;Passbolt AWS AMI comes with a preinstalled mariadb database. The credentials for
this database are randomly generated on the first boot and the webinstaller autofills
those credentials for you. The autogenerated database credentials will be
available for later use by administrators in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/passbolt/passbolt.php&lt;/code&gt; file.&lt;/p&gt;

    &lt;p&gt;If you decide to use the autogenerated credentials you
can click the “Next” button and move to the next step on this tutorial.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/02/web-installer-pro-database.png&quot; alt=&quot;wizard - database&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - database&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;&lt;strong&gt;Optional:&lt;/strong&gt; in case you do not want to use the autogenerated mariadb
credentials you could connect through ssh to your instance
and use the mariadb root credentials to create a new
user, password and database for passbolt to use:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh admin@&amp;lt;your_domain|instance_ip&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;You can find the root database credentials in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/.mysql_credentials&lt;/code&gt; file:&lt;/p&gt;

    &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sudo cat /root/.mysql_credentials
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Once you have the root database credentials you can connect to the local mariadb
and create any database and user you want to use to install passbolt.&lt;/p&gt;

    &lt;h3 id=&quot;gpg-key&quot;&gt;2.3. GPG key&lt;/h3&gt;

    &lt;p&gt;In this section you can either generate or import a GPG key pair. This key pair will be used by passbolt API to 
authenticate itself during the login handshake process.&lt;/p&gt;

    &lt;p&gt;Generate a key if you don’t have one.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-server-key-generate.png&quot; alt=&quot;wizard - generate a key pair&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - generate a key pair&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Import a key if you already have one and you want your server to use it.&lt;/p&gt;

    &lt;p&gt;&lt;div class=&quot;message warning&quot;&gt;
    &lt;strong&gt;Do not set a passphrase or an expiration date&lt;/strong&gt;
    The php-gnupg module does not support using passphrase at the moment. Make sure you do not set a passphrase.
    Similarly do not set an expiration date. Otherwise all your users will need to
    perform an account recovery when you will eventually need to update the key.
&lt;/div&gt;&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-server-key-import.png&quot; alt=&quot;wizard - import a key pair&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - import a key pair&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;mail-server-smtp&quot;&gt;2.4. Mail server (SMTP)&lt;/h3&gt;

    &lt;p&gt;At this stage, the wizard will ask you to enter the details of your SMTP server.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-email.png&quot; alt=&quot;wizard - smtp mail server details&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - smtp mail server details&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;You can also test that your configuration is correct by using the test email feature at the right of your screen. Enter
the email address at which you want the wizard to send you a test email and click on “Send test email”.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/04/wizard-test-email.png&quot; alt=&quot;wizard - test smtp settings&quot; style=&quot;max-width:300px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - test smtp settings&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;preferences&quot;&gt;2.5. Preferences&lt;/h3&gt;

    &lt;p&gt;The wizard will then ask you what preferences you prefer for your instance of passbolt. The recommended defaults are already pre-populated
but you can also change them if you know what you are doing.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-options.png&quot; alt=&quot;wizard - preferences&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - preferences&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;first-user-creation&quot;&gt;2.6. First user creation&lt;/h3&gt;

    &lt;p&gt;You need to create the first admin user account. This first admin user is probably you, so enter your details and click on next.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-first-user.png&quot; alt=&quot;wizard - first user&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - first user&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;installation&quot;&gt;2.7. Installation&lt;/h3&gt;

    &lt;p&gt;That’s it. The wizard has now enough information to proceed with the configuration of passbolt. Sit back and relax for a few seconds while
the configuration process is going on.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-install.png&quot; alt=&quot;wizard - installation&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - installation&lt;/span&gt;
&lt;/figure&gt;

    &lt;p&gt;Your user account is now created. You will see a redirection page for a few second and then will be redirected
to the user setup process so that you can configure your user account.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2018/11/web-installer-pro-completed.png&quot; alt=&quot;wizard - completion and redirection&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. wizard - completion and redirection&lt;/span&gt;
&lt;/figure&gt;

    &lt;h2 id=&quot;configure-your-administrator-account&quot;&gt;3. Configure your administrator account&lt;/h2&gt;

    &lt;h3 id=&quot;download-the-plugin&quot;&gt;3.1. Download the plugin&lt;/h3&gt;

    &lt;p&gt;Before continuing passbolt will require you to download its plugin. If you already have it installed you can go to the
next step.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/02/user-setup-download-browser-extension.png&quot; alt=&quot;download the browser extension&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. download the browser extension&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;create-a-new-key&quot;&gt;3.2. Create a new key&lt;/h3&gt;

    &lt;p&gt;Passbolt will ask you to create or import a key that will be later use to identify you and encrypt your passwords.
Your key needs to be protected by a password. Choose it wisely, it will be the gatekeeper to all your other passwords.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/02/user-setup-generate-key.png&quot; alt=&quot;generate a key&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. generate a key&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;download-your-recovery-kit&quot;&gt;3.3. Download your recovery kit&lt;/h3&gt;

    &lt;p&gt;This step is essential. Your key is the only way to access your account and passwords. If you lose this key (by breaking
or losing your computer and not having a backup for example), your encrypted data will be lost even if you remember your
passphrase.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/02/user-setup-download-recovery-kit.png&quot; alt=&quot;download the recovery kit&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. download the recovery kit&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;define-your-security-token&quot;&gt;3.4. Define your security token&lt;/h3&gt;

    &lt;p&gt;Choosing a color and a three characters token is a secondary security mechanism that helps you to mitigate phishing
attacks. Each time you are performing a sensitive operation on passbolt, you should see this token.&lt;/p&gt;

    &lt;figure&gt;
    &lt;img src=&quot;https://help.passbolt.com/assets/img/help/2021/02/user-setup-security-token.png&quot; alt=&quot;define your security token&quot; style=&quot;max-width:586px;&quot; /&gt;
    &lt;span class=&quot;legend&quot;&gt;fig. define your security token&lt;/span&gt;
&lt;/figure&gt;

    &lt;h3 id=&quot;thats-it&quot;&gt;3.5. That’s it!&lt;/h3&gt;

    &lt;p&gt;Your administrator account is configured. You will be redirected to the login page of passbolt. Enjoy!&lt;/p&gt;

    &lt;div class=&quot;last-updated&quot;&gt;
      &lt;h3&gt;Last updated&lt;/h3&gt;
      &lt;p&gt;This article was last updated on 
August
11th,
2021.&lt;/p&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col4 last push1&quot;&gt;

    &lt;div class=&quot;message tldr notice&quot;&gt;
    &lt;p&gt;Are you experiencing issues with Passbolt Pro Edition?&lt;/p&gt;
    &lt;a href=&quot;mailto:contact@passbolt.com&quot; class=&quot;button primary&quot;&gt;Contact Pro support&lt;/a&gt;
    &lt;p&gt;or &lt;a href=&quot;https://community.passbolt.com&quot;&gt;ask the community&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;

    &lt;div class=&quot;message tldr&quot;&gt;
    &lt;p&gt;Something is not accurate in this documentation? You can contribute by opening an issue or making pull requests!&lt;/p&gt;
    
    &lt;a href=&quot;https://www.github.com/passbolt/passbolt_help&quot; class=&quot;button &quot;&gt;View on github&lt;/a&gt;
    
&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><category term="hosting" /><category term="install" /><category term="pro" /><summary type="html"></summary></entry></feed>